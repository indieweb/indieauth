<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="utf-8"><meta name="generator" content="ReSpec 25.6.0"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><style>span.example-title{text-transform:none}aside.example,div.example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}div.illegal-example{color:red}div.illegal-example p{color:#000}aside.example,div.example{padding:.5em;border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}aside.example div.example span.example-title{color:#999}</style>
    <title>IndieAuth</title>
    
    
    
    
    
    <link rel="pingback" href="https://indieauth.net/pingback">
    <link rel="webmention" href="https://indieauth.net/webmention">
  <style id="respec-mainstyle">@keyframes pop{0%{transform:scale(1,1)}25%{transform:scale(1.25,1.25);opacity:.75}100%{transform:scale(1,1)}}.hljs{background:0 0!important}a abbr,h1 abbr,h2 abbr,h3 abbr,h4 abbr,h5 abbr,h6 abbr{border:none}dfn{font-weight:700}a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}a.bibref{text-decoration:none}.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}@supports not (text-decoration:red wavy underline){.respec-offending-element:not(pre){display:inline-block}.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}}#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}cite .bibref{font-style:normal}code{color:#c63501}th code{color:inherit}a[href].orcid{padding-left:4px;padding-right:4px}a[href].orcid>svg{margin-bottom:-2px}.toc a,.tof a{text-decoration:none}a .figno,a .secno{color:#000}ol.tof,ul.tof{list-style:none outside none}.caption{margin-top:.5em;font-style:italic}table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}.simple th a{color:#fff;padding:3px 5px;text-align:left}.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}.simple td{padding:3px 10px;border-top:1px solid #ddd}.simple tr:nth-child(even){background:#f0f6ff}.section dd>p:first-child{margin-top:0}.section dd>p:last-child{margin-bottom:0}.section dd{margin-bottom:1em}.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}#issue-summary>ul,.respec-dfn-list{column-count:2}#issue-summary li,.respec-dfn-list li{list-style:none}details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}details.respec-tests-details>*{padding-right:2em}details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}details.respec-tests-details>ul{width:100%;margin-top:-.3em}details.respec-tests-details>li{padding-left:1em}a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}h2,h3,h4,h5,h6{position:relative}aside.example .marker>a.self-link{color:inherit}h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}h2>a.self-link::before,h3>a.self-link::before,h4>a.self-link::before,h5>a.self-link::before,h6>a.self-link::before{content:"§";display:block}@media (max-width:767px){dd{margin-left:0}h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{left:auto;top:auto}}@media print{.removeOnSave{display:none}}</style><meta name="description" content="IndieAuth is an identity layer on top of OAuth 2.0 [RFC6749], primarily used to obtain
        an OAuth 2.0 Bearer Token [RFC6750] for use by [Micropub] clients. End-Users
        and Clients are all represented by URLs. IndieAuth enables Clients to
        verify the identity of an End-User, as well as to obtain an access
        token that can be used to access resources under the control of the End-User."><link rel="canonical" href="https://www.w3.org/TR/indieauth/"><style>.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#717277;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}.hljs-literal{color:#0b76c5}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><style>var{position:relative;cursor:pointer}var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}</style><script id="initialUserConfig" type="application/json">{
  "useExperimentalStyles": true,
  "publishDate": "2024-07-11",
  "specStatus": "NOTE",
  "previousPublishDate": "2022-02-12",
  "previousMaturity": "LS",
  "previousVersionURL": "https://indieauth.spec.indieweb.org/20220212/",
  "shortName": "indieauth",
  "lsURI": "https://indieauth.spec.indieweb.org/",
  "testSuiteURI": "https://indieauth.rocks/",
  "editors": [
    {
      "name": "Aaron Parecki",
      "url": "https://aaronparecki.com/",
      "w3cid": "59996"
    }
  ],
  "wg": "Social Web Working Group",
  "wgURI": "https://www.w3.org/Social/WG",
  "wgPublicList": "public-socialweb",
  "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/72531/status",
  "errata": "https://indieauth.net/errata",
  "license": "w3c-software-doc",
  "postProcess": [
    null,
    null
  ],
  "maxTocLevel": 3,
  "otherLinks": [
    {
      "key": "Repository",
      "data": [
        {
          "value": "Github",
          "href": "https://github.com/indieweb/indieauth"
        },
        {
          "value": "Issues",
          "href": "https://github.com/indieweb/indieauth/issues"
        },
        {
          "value": "Commits",
          "href": "https://github.com/indieweb/indieauth/commits/main"
        }
      ]
    }
  ],
  "localBiblio": {
    "microformats2-parsing": {
      "title": "Microformats2 Parsing",
      "href": "https://microformats.org/wiki/microformats2-parsing",
      "authors": [
        "Tantek Çelik"
      ],
      "status": "Living Specification",
      "publisher": "microformats.org"
    },
    "h-entry": {
      "title": "h-entry",
      "href": "https://microformats.org/wiki/h-entry",
      "authors": [
        "Tantek Çelik"
      ],
      "status": "Living Specification",
      "publisher": "microformats.org"
    },
    "RelMeAuth": {
      "title": "RelMeAuth",
      "href": "https://microformats.org/wiki/RelMeAuth",
      "authors": [
        "Tantek Çelik"
      ],
      "status": "Living Specification",
      "publisher": "microformats.org",
      "id": "relmeauth"
    },
    "XFN11": {
      "title": "XFN 1.1",
      "href": "https://gmpg.org/xfn/11",
      "authors": [
        "Tantek Çelik",
        "Matthew Mullenweg",
        "Eric Meyer"
      ],
      "status": "Stable",
      "publisher": "Global Multimedia Protocols Group"
    },
    "URL": {
      "title": "URL Standard",
      "href": "https://url.spec.whatwg.org/",
      "authors": [
        "Anne van Kesteren"
      ],
      "status": "Living Standard",
      "publisher": "WHATWG",
      "id": "url"
    },
    "ClientIDMetadataDocument": {
      "title": "OAuth Client ID Metadata Document",
      "href": "https://datatracker.ietf.org/doc/html/draft-parecki-oauth-client-id-metadata-document",
      "authors": [
        "Aaron Parecki",
        "Emelia Smith"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF",
      "id": "clientidmetadatadocument"
    },
    "ClientMetadata": {
      "title": "OAuth Dynamic Client Registration Metadata",
      "href": "https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata",
      "authors": [
        "IETF"
      ],
      "status": "Registry",
      "publisher": "IANA",
      "id": "clientmetadata"
    }
  },
  "publishISODate": "2024-07-11T00:00:00.000Z",
  "generatedSubtitle": "Working Group Note 11 July 2024"
}</script><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-NOTE"></head>
  <body class="h-entry informative" style="background-image: url(&quot;https://spec.indieweb.org/INDIEWEB-LIVING-STANDARD.svg&quot;);"><div class="head">
    <a class="logo" href="https://www.w3.org/"><img alt="W3C" width="120" height="100" src="https://spec.indieweb.org/index_files/logo.svg"></a> <h1 id="title" class="title">IndieAuth</h1>
    
    <h2>IndieWeb Living Standard 11 July 2024</h2>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://indieauth.spec.indieweb.org/">https://indieauth.spec.indieweb.org/</a>
            </dd>
      
      <dt>Test suite:</dt><dd><a href="https://indieauth.rocks/">https://indieauth.rocks/</a></dd>
      
      
      <dt>Previous version:</dt><dd><a href="https://indieauth.spec.indieweb.org/20220212/">https://indieauth.spec.indieweb.org/20220212/</a></dd>
      
      <dt>Editor:</dt>
      <dd class="p-author h-card vcard" data-editor-id="59996"><a class="u-url url p-name fn" href="https://aaronparecki.com/">Aaron Parecki</a></dd>
      
      
      <dt>Repository:</dt><dd>
    <a href="https://github.com/indieweb/indieauth">Github</a>
  </dd><dd>
    <a href="https://github.com/indieweb/indieauth/issues">Issues</a>
  </dd><dd>
    <a href="https://github.com/indieweb/indieauth/commits/main">Commits</a>
  </dd>
    </dl>
    <p>
          Please check the
          <a href="https://indieauth.net/errata"><strong>errata</strong></a> for any errors or
          issues reported since publication.
        </p>
    
    
    <p class="copyright"><b>License:</b> Per <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>, to the extent possible under law, the editor(s) and contributors have waived all copyright and related or neighboring rights to this work. In addition, the editor(s) and contributors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">Open Web Foundation Agreement Version 1.0</a>.</p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p id="abstract-p-1">
        IndieAuth is an identity layer on top of OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], primarily used to obtain
        an OAuth 2.0 Bearer Token [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6750" title="The OAuth 2.0 Authorization Framework: Bearer Token Usage">RFC6750</a></cite>] for use by [<cite><a class="bibref" data-link-type="biblio" href="#bib-micropub" title="Micropub">Micropub</a></cite>] clients. End-Users
        and Clients are all represented by URLs. IndieAuth enables Clients to
        verify the identity of an End-User, as well as to obtain an access
        token that can be used to access resources under the control of the End-User.
      </p>

      <section id="authorsnote" class="informative">
        <h3 id="author-s-note">Author's Note<a class="self-link" aria-label="§" href="#authorsnote"></a></h3><p id="authorsnote-p-1"><em>This section is non-normative.</em></p>
        <p id="authorsnote-p-2">This specification was contributed to the <abbr title="World Wide Web Consortium">W3C</abbr> from the
          <a href="https://indieweb.org/">IndieWeb</a> community. More
          history and evolution of IndieAuth can be found on the
          <a href="https://indieweb.org/IndieAuth-spec">IndieWeb wiki</a>.</p>
      </section>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2>
    <p>This document was published by the IndieWeb community as a Living Standard.</p><p>Per <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>, to the extent possible under law, the editor(s) and contributors have waived all copyright and related or neighboring rights to this work. In addition, the editor(s) and contributors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">Open Web Foundation Agreement Version 1.0</a>.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#background"><bdi class="secno">1.1 </bdi>Background</a></li><li class="tocline"><a class="tocxref" href="#oauth-2-0-extension"><bdi class="secno">1.2 </bdi>OAuth 2.0 Extension</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>Conformance</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#conformance-classes"><bdi class="secno">2.1 </bdi>Conformance Classes</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-endpoint"><bdi class="secno">2.1.1 </bdi>Authorization Endpoint</a></li><li class="tocline"><a class="tocxref" href="#token-endpoint"><bdi class="secno">2.1.2 </bdi>Token Endpoint</a></li><li class="tocline"><a class="tocxref" href="#micropub-client"><bdi class="secno">2.1.3 </bdi>Micropub Client</a></li><li class="tocline"><a class="tocxref" href="#indieauth-client"><bdi class="secno">2.1.4 </bdi>IndieAuth Client</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#identifiers"><bdi class="secno">3. </bdi>Identifiers</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#issuer-identifier"><bdi class="secno">3.1 </bdi>Issuer Identifier</a></li><li class="tocline"><a class="tocxref" href="#user-profile-url"><bdi class="secno">3.2 </bdi>User Profile URL</a></li><li class="tocline"><a class="tocxref" href="#client-identifier"><bdi class="secno">3.3 </bdi>Client Identifier</a></li><li class="tocline"><a class="tocxref" href="#url-canonicalization"><bdi class="secno">3.4 </bdi>URL Canonicalization</a></li></ol></li><li class="tocline"><a class="tocxref" href="#discovery"><bdi class="secno">4. </bdi>Discovery</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#discovery-by-clients"><bdi class="secno">4.1 </bdi>Discovery by Clients</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#indieauth-server-metadata"><bdi class="secno">4.1.1 </bdi>IndieAuth Server Metadata</a></li></ol></li><li class="tocline"><a class="tocxref" href="#client-information-discovery"><bdi class="secno">4.2 </bdi>Client Information Discovery</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#client-metadata"><bdi class="secno">4.2.1 </bdi>Client Metadata</a></li><li class="tocline"><a class="tocxref" href="#redirect-url"><bdi class="secno">4.2.2 </bdi>Redirect URL</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#authorization"><bdi class="secno">5. </bdi>Authorization</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#discovery-0"><bdi class="secno">5.1 </bdi>Discovery</a></li><li class="tocline"><a class="tocxref" href="#authorization-request"><bdi class="secno">5.2 </bdi>Authorization Request</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-response"><bdi class="secno">5.2.1 </bdi>Authorization Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#redeeming-the-authorization-code"><bdi class="secno">5.3 </bdi>Redeeming the Authorization Code</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request"><bdi class="secno">5.3.1 </bdi>Request</a></li><li class="tocline"><a class="tocxref" href="#profile-url-response"><bdi class="secno">5.3.2 </bdi>Profile URL Response</a></li><li class="tocline"><a class="tocxref" href="#access-token-response"><bdi class="secno">5.3.3 </bdi>Access Token Response</a></li><li class="tocline"><a class="tocxref" href="#profile-information"><bdi class="secno">5.3.4 </bdi>Profile Information</a></li></ol></li><li class="tocline"><a class="tocxref" href="#authorization-server-confirmation"><bdi class="secno">5.4 </bdi>Authorization Server Confirmation</a></li><li class="tocline"><a class="tocxref" href="#refresh-tokens"><bdi class="secno">5.5 </bdi>Refresh Tokens</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#refreshing-an-access-token"><bdi class="secno">5.5.1 </bdi>Refreshing an Access Token</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#access-token-verification"><bdi class="secno">6. </bdi>Access Token Verification</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#access-token-verification-request"><bdi class="secno">6.1 </bdi>Access Token Verification Request</a></li><li class="tocline"><a class="tocxref" href="#access-token-verification-response"><bdi class="secno">6.2 </bdi>Access Token Verification Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#token-revocation"><bdi class="secno">7. </bdi>Token Revocation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#token-revocation-request"><bdi class="secno">7.1 </bdi>Token Revocation Request</a></li></ol></li><li class="tocline"><a class="tocxref" href="#accessing-protected-resources"><bdi class="secno">8. </bdi>Accessing Protected Resources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#error-responses"><bdi class="secno">8.1 </bdi>Error Responses</a></li></ol></li><li class="tocline"><a class="tocxref" href="#user-information"><bdi class="secno">9. </bdi>User Information</a></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">10. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#preventing-phishing-and-redirect-attacks"><bdi class="secno">10.1 </bdi>Preventing Phishing and Redirect Attacks</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-considerations"><bdi class="secno">11. </bdi>IANA Considerations</a></li><li class="tocline"><a class="tocxref" href="#resources"><bdi class="secno">A. </bdi>Resources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#articles"><bdi class="secno">A.1 </bdi>Articles</a></li><li class="tocline"><a class="tocxref" href="#implementations"><bdi class="secno">A.2 </bdi>Implementations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#change-log"><bdi class="secno">C. </bdi>Change Log</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#changes-from-12-february-2022-to-this-version"><bdi class="secno">C.1 </bdi>Changes from 12 February 2022 to this version</a></li><li class="tocline"><a class="tocxref" href="#changes-from-26-november-2020-to-12-february-2022"><bdi class="secno">C.2 </bdi>Changes from 26 November 2020 to 12 February 2022</a></li><li class="tocline"><a class="tocxref" href="#changes-from-26-september-2020-to-26-november-2020"><bdi class="secno">C.3 </bdi>Changes from 26 September 2020 to 26 November 2020</a></li><li class="tocline"><a class="tocxref" href="#changes-from-09-august-2020-to-26-september-2020"><bdi class="secno">C.4 </bdi>Changes from 09 August 2020 to 26 September 2020</a></li><li class="tocline"><a class="tocxref" href="#changes-from-25-january-2020-to-09-august-2020"><bdi class="secno">C.5 </bdi>Changes from 25 January 2020 to 09 August 2020</a></li><li class="tocline"><a class="tocxref" href="#changes-from-03-march-2019-to-25-january-2020"><bdi class="secno">C.6 </bdi>Changes from 03 March 2019 to 25 January 2020</a></li><li class="tocline"><a class="tocxref" href="#changes-from-07-july-2018-to-03-march-2019"><bdi class="secno">C.7 </bdi>Changes from 07 July 2018 to 03 March 2019</a></li><li class="tocline"><a class="tocxref" href="#changes-from-23-january-2018-to-07-july-2018"><bdi class="secno">C.8 </bdi>Changes from <span class="formerLink">23 January 2018</span> to 07 July 2018</a></li><li class="tocline"><a class="tocxref" href="#changes-from-07-july-2018-to-03-march-2019-0"><bdi class="secno">C.9 </bdi>Changes from 07 July 2018 to 03 March 2019</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>
        Normative references
      </a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>
        Informative references
      </a></li></ol></li></ol></nav>

    <section id="introduction">
      <h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction<a class="self-link" aria-label="§" href="#introduction"></a></h2>

      <section class="informative" id="background">
        <h3 id="x1-1-background"><bdi class="secno">1.1 </bdi>Background<a class="self-link" aria-label="§" href="#background"></a></h3><p id="background-p-1"><em>This section is non-normative.</em></p>

        <p id="background-p-2">The IndieAuth spec began as a way to obtain an OAuth 2.0 access token for use by Micropub clients. It can be used to both obtain an access token, as well as authenticate users signing to any application. It is built on top of the OAuth 2.0 framework, and while this document should provide enough guidance for implementers, referring to the core OAuth 2.0 spec can help answer any remaining questions. More information can be found <a href="https://indieweb.org/IndieAuth-spec">on the IndieWeb wiki</a>.</p>
      </section>

      <section class="normative" id="oauth-2-0-extension">
        <h3 id="x1-2-oauth-2-0-extension"><bdi class="secno">1.2 </bdi>OAuth 2.0 Extension<a class="self-link" aria-label="§" href="#oauth-2-0-extension"></a></h3>

        <p id="oauth-2-0-extension-p-1">IndieAuth builds upon the OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] Framework as follows</p>

        <ul>
          <li id="oauth-2-0-extension-li-1">Specifies a format for user identifiers (a resolvable URL)</li>
          <li id="oauth-2-0-extension-li-2">Specifies a method of discovering the IndieAuth metadata (containing the authorization and token endpoints) given a user's profile URL</li>
          <li id="oauth-2-0-extension-li-3">Specifies a format for the Client ID (a resolvable URL containing client metadata)</li>
          <li id="oauth-2-0-extension-li-4">Client registration at the authorization endpoint is not necessary, since client IDs are resolvable URLs</li>
          <li id="oauth-2-0-extension-li-5">Redirect URL registration happens by verifying data fetched at the Client ID URL</li>
          <li id="oauth-2-0-extension-li-6">Specifies a mechanism for returning the user identifier and profile information for the user who authorized a request</li>
        </ul>

        <p id="oauth-2-0-extension-p-2">Additionally, the parameters defined by OAuth 2.0 (in particular <code>state</code>, <code>code</code>, and <code>scope</code>) follow the same syntax requirements as defined by Appendix A of OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>].</p>
      </section>
    </section>

    <section class="normative" id="conformance">
      <h2 id="x2-conformance"><bdi class="secno">2. </bdi>Conformance<a class="self-link" aria-label="§" href="#conformance"></a></h2>

      <p id="conformance-p-1">The key words "<em class="rfc2119" title="MUST">MUST</em>", "<em class="rfc2119" title="MUST NOT">MUST NOT</em>", "<em class="rfc2119" title="REQUIRED">REQUIRED</em>", "<em class="rfc2119" title="SHALL">SHALL</em>", "<em class="rfc2119" title="SHALL NOT">SHALL NOT</em>",
      "<em class="rfc2119" title="SHOULD">SHOULD</em>", "<em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em>", "<em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em>", "<em class="rfc2119" title="MAY">MAY</em>", and "<em class="rfc2119" title="OPTIONAL">OPTIONAL</em>" in this
      document are to be interpreted as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>].</p>

      <section id="conformance-classes">
        <h3 id="x2-1-conformance-classes"><bdi class="secno">2.1 </bdi>Conformance Classes<a class="self-link" aria-label="§" href="#conformance-classes"></a></h3>

        <p id="conformance-classes-p-1">An IndieAuth implementation can implement one or more of the roles of an IndieAuth server or client. This section describes the conformance criteria for each role.</p>

        <p id="conformance-classes-p-2">Listed below are known types of IndieAuth implementations.</p>

        <section id="authorization-endpoint">
          <h4 id="x2-1-1-authorization-endpoint"><bdi class="secno">2.1.1 </bdi>Authorization Endpoint<a class="self-link" aria-label="§" href="#authorization-endpoint"></a></h4>
          <p id="authorization-endpoint-p-1">An IndieAuth Authorization Endpoint is responsible for obtaining authentication or authorization consent from the end user and generating and verifying authorization codes.</p>
        </section>

        <section id="token-endpoint">
          <h4 id="x2-1-2-token-endpoint"><bdi class="secno">2.1.2 </bdi>Token Endpoint<a class="self-link" aria-label="§" href="#token-endpoint"></a></h4>
          <p id="token-endpoint-p-1">An IndieAuth Token Endpoint is responsible for generating and verifying OAuth 2.0 Bearer Tokens.</p>
        </section>

        <section id="micropub-client">
          <h4 id="x2-1-3-micropub-client"><bdi class="secno">2.1.3 </bdi>Micropub Client<a class="self-link" aria-label="§" href="#micropub-client"></a></h4>
          <p id="micropub-client-p-1">A Micropub client will attempt to obtain an OAuth 2.0 Bearer Token given a URL that allows the discovery of an Authorization Endpoint, and will use the token when making Micropub requests.</p>
        </section>

        <section id="indieauth-client">
          <h4 id="x2-1-4-indieauth-client"><bdi class="secno">2.1.4 </bdi>IndieAuth Client<a class="self-link" aria-label="§" href="#indieauth-client"></a></h4>
          <p id="indieauth-client-p-1">An IndieAuth client is a client that is attempting to authenticate a user given a URL that allows the discovery of an Authorization Endpoint, but does not need an OAuth 2.0 Bearer Token.</p>
        </section>

      </section>
    </section>

    <section class="normative" id="identifiers">
      <h2 id="x3-identifiers"><bdi class="secno">3. </bdi>Identifiers<a class="self-link" aria-label="§" href="#identifiers"></a></h2>

      <section id="issuer-identifier">
        <h3 id="x3-1-issuer-identifier"><bdi class="secno">3.1 </bdi>Issuer Identifier<a class="self-link" aria-label="§" href="#issuer-identifier"></a></h3>

        <p id="issuer-identifier-p-1">The issuer identifier of the authorization server, which is primarily used to prevent authorization server mix-up attacks. The issuer identifier is a URL that uses the "https" scheme and has no query or fragment components as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9207" title="OAuth 2.0 Authorization Server Issuer Identification">RFC9207</a></cite>], however, the identifier <em class="rfc2119" title="MUST">MUST</em> also be a prefix of the <code>indieauth-metadata</code> URL. For example, for an <code>indieauth-metadata</code> endpoint <code>https://example.com/.well-known/oauth-authorization-server</code>, the issuer URL could be <code>https://example.com/</code>, or for a metadata URL of <code>https://example.com/wp-json/indieauth/1.0/metadata</code>, the issuer URL could be <code>https://example.com/wp-json/indieauth/1.0</code></p>

      </section>
      <section id="user-profile-url">
        <h3 id="x3-2-user-profile-url"><bdi class="secno">3.2 </bdi>User Profile URL<a class="self-link" aria-label="§" href="#user-profile-url"></a></h3>

        <p id="user-profile-url-p-1">Users are identified by a [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. Profile URLs <em class="rfc2119" title="MUST">MUST</em> have either an <code>https</code> or <code>http</code> scheme, <em class="rfc2119" title="MUST">MUST</em> contain a path component (<code>/</code> is a valid path), <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain single-dot or double-dot path segments, <em class="rfc2119" title="MAY">MAY</em> contain a query string component, <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain a fragment component, <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain a username or password component, and <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain a port. Additionally, host names <em class="rfc2119" title="MUST">MUST</em> be domain names and <em class="rfc2119" title="MUST NOT">MUST NOT</em> be ipv4 or ipv6 addresses.</p>

        <p id="user-profile-url-p-2">Some examples of valid profile URLs are:</p>

        <ul>
          <li id="user-profile-url-li-1"><code>https://example.com/</code></li>
          <li id="user-profile-url-li-2"><code>https://example.com/username</code></li>
          <li id="user-profile-url-li-3"><code>https://example.com/users?id=100</code></li>
        </ul>

        <p id="user-profile-url-p-3">Some examples of invalid profile URLs are:</p>
        <ul>
          <li id="user-profile-url-li-4"><s><code>example.com</code></s> - missing scheme</li>
          <li id="user-profile-url-li-5"><s><code>mailto:user@example.com</code></s> - invalid scheme</li>
          <li id="user-profile-url-li-6"><s><code>https://example.com/foo/../bar</code></s> - contains a double-dot path segment</li>
          <li id="user-profile-url-li-7"><s><code>https://example.com/#me</code></s> - contains a fragment</li>
          <li id="user-profile-url-li-8"><s><code>https://user:pass@example.com/</code></s> - contains a username and password</li>
          <li id="user-profile-url-li-9"><s><code>https://example.com:8443/</code></s> - contains a port</li>
          <li id="user-profile-url-li-10"><s><code>https://172.28.92.51/</code></s> - host is an IP address</li>
        </ul>
      </section>

      <section id="client-identifier">
        <h3 id="x3-3-client-identifier"><bdi class="secno">3.3 </bdi>Client Identifier<a class="self-link" aria-label="§" href="#client-identifier"></a></h3>

        <p id="client-identifier-p-1">Clients are identified by a [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. Client identifier URLs <em class="rfc2119" title="MUST">MUST</em> have either an <code>https</code> or <code>http</code> scheme, <em class="rfc2119" title="MUST">MUST</em> contain a path component, <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain single-dot or double-dot path segments, <em class="rfc2119" title="MAY">MAY</em> contain a query string component, <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain a fragment component, <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain a username or password component, and <em class="rfc2119" title="MAY">MAY</em> contain a port. Additionally, host names <em class="rfc2119" title="MUST">MUST</em> be domain names or a loopback interface and <em class="rfc2119" title="MUST NOT">MUST NOT</em> be IPv4 or IPv6 addresses except for IPv4 <code>127.0.0.1</code> or IPv6 <code>[::1]</code>.</p>
      </section>

      <section id="url-canonicalization">
        <h3 id="x3-4-url-canonicalization"><bdi class="secno">3.4 </bdi>URL Canonicalization<a class="self-link" aria-label="§" href="#url-canonicalization"></a></h3>

        <p id="url-canonicalization-p-1">Since IndieAuth uses https/http URLs which fall under what [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] calls "<a href="https://url.spec.whatwg.org/#special-scheme">Special URLs</a>", a string with no path component is not a valid [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. As such, if a URL with no path component is ever encountered, it <em class="rfc2119" title="MUST">MUST</em> be treated as if it had the path <code>/</code>. For example, if a user provides <code>https://example.com</code> for Discovery, the client <em class="rfc2119" title="MUST">MUST</em> transform it to <code>https://example.com/</code> when using it and comparing it.</p>

        <p id="url-canonicalization-p-2">Since domain names are case insensitive, the host component of the URL <em class="rfc2119" title="MUST">MUST</em> be compared case insensitively. Implementations <em class="rfc2119" title="SHOULD">SHOULD</em> convert the host to lowercase when storing and using URLs.</p>

        <p id="url-canonicalization-p-3">For ease of use, clients <em class="rfc2119" title="MAY">MAY</em> allow users to enter just the host part of the URL, in which case the client <em class="rfc2119" title="MUST">MUST</em> turn that into a valid URL before beginning the IndieAuth flow, by prepending either an <code>http</code> or <code>https</code> scheme and appending the path <code>/</code>. For example, if the user enters <code>example.com</code>, the client transforms it into <code>http://example.com/</code> before beginning discovery.</p>
      </section>

    </section>

    <section class="normative" id="discovery">
      <h2 id="x4-discovery"><bdi class="secno">4. </bdi>Discovery<a class="self-link" aria-label="§" href="#discovery"></a></h2>

      <p id="discovery-p-1">This specification uses the link rel registry as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]
        for both HTML and HTTP link relations.</p>

      <section id="discovery-by-clients">
        <h3 id="x4-1-discovery-by-clients"><bdi class="secno">4.1 </bdi>Discovery by Clients<a class="self-link" aria-label="§" href="#discovery-by-clients"></a></h3>

        <p id="discovery-by-clients-p-1">Clients need to discover a few pieces of information when a user signs in. The client needs to discover the user's <code>indieauth-metadata</code> endpoint, which provides the location of the IndieAuth server's authorization endpoint and token endpoint, as well as other relevant information for the client. Clients <em class="rfc2119" title="MUST">MUST</em> start by making a GET or HEAD request to [<cite><a class="bibref" data-link-type="biblio" href="#bib-fetch" title="Fetch Standard">Fetch</a></cite>] the user provided URL to discover the necessary values. Clients <em class="rfc2119" title="MUST">MUST</em> follow HTTP redirects (up to a self-imposed limit). When using the Authorization flow to obtain an access token for use at another endpoint, such as a [<cite><a class="bibref" data-link-type="biblio" href="#bib-micropub" title="Micropub">Micropub</a></cite>] endpoint, the client will also discover the <code>micropub</code> endpoint.</p>

        <p id="discovery-by-clients-p-2">Clients <em class="rfc2119" title="MUST">MUST</em> check for an HTTP <code>Link</code> header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>] with a <code>rel</code> value of <code>indieauth-metadata</code>. If the content type of the document is HTML, then the client <em class="rfc2119" title="MUST">MUST</em> check for an HTML <code>&lt;link&gt;</code> element with a <code>rel</code> value of <code>indieauth-metadata</code>. If more than one of these is present, the first HTTP <code>Link</code> header takes precedence, followed by the first <code>&lt;link&gt;</code> element in document order.</p>

        <p id="discovery-by-clients-p-3">The URLs discovered <em class="rfc2119" title="MAY">MAY</em> be relative URLs, in which case the client <em class="rfc2119" title="MUST">MUST</em> resolve them relative to the current document URL according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>].</p>

        <p id="discovery-by-clients-p-4">Clients <em class="rfc2119" title="MAY">MAY</em> initially make an HTTP HEAD request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7231" title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>] to follow redirects and check for the <code>Link</code> header before making a GET request.</p>

        <p id="discovery-by-clients-p-5">In the event there is no <code>indieauth-metadata</code> URL provided, for compatibility with previous revisions of IndieAuth, the client <em class="rfc2119" title="SHOULD">SHOULD</em> look for an HTTP <code>Link</code> header and HTML <code>&lt;link&gt;</code> element with a <code>rel</code> value of <code>authorization_endpoint</code> (and optionally <code>token_endpoint</code>) following the same order of predence as described above.</p>

        <p class="advisement" id="discovery-by-clients-p-6">
          Note that the recommendation of looking for the <code>rel=authorization_endpoint</code> and <code>rel=token_endpoint</code> are included for backwards compatibility with previous IndieAuth profiles and may be removed from this specification in the future after wide enough adoption of the newer <code>indieauth-metadata</code> discovery method.
        </p>

         <section id="indieauth-server-metadata">
            <h4 id="x4-1-1-indieauth-server-metadata"><bdi class="secno">4.1.1 </bdi>IndieAuth Server Metadata<a class="self-link" aria-label="§" href="#indieauth-server-metadata"></a></h4>

            <p id="indieauth-server-metadata-p-1">IndieAuth metadata adopts OAuth 2.0 Authorization Server Metadata [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>], with the notable difference that discovery of the URL happens via the IndieAuth link relation rather than the <code>.well-known</code> discovery method specified by RFC8414. For compatibility with other OAuth 2.0 implementations, use of the <code>.well-known</code> path as defined in RFC8414 is <em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em> but optional.</p>

            <p id="indieauth-server-metadata-p-2">The metadata endpoint returns information about the server as a JSON object with the following properties:</p>

            <ul>
              <li id="indieauth-server-metadata-li-1"><code>issuer</code> - The server's issuer identifier.</li>
              <li id="indieauth-server-metadata-li-2"><code>authorization_endpoint</code> - The Authorization Endpoint</li>
              <li id="indieauth-server-metadata-li-3"><code>token_endpoint</code> - The Token Endpoint</li>
              <li id="indieauth-server-metadata-li-4"><code>introspection_endpoint</code> - The Introspection Endpoint</li>
              <li id="indieauth-server-metadata-li-5"><code>introspection_endpoint_auth_methods_supported</code> (optional) - JSON array containing a list of client authentication methods supported by this introspection endpoint.
              </li><li id="indieauth-server-metadata-li-6"><code>revocation_endpoint</code> (optional) - The Revocation Endpoint</li>
              <li id="indieauth-server-metadata-li-7"><code>revocation_endpoint_auth_methods_supported</code> (optional) - JSON array containing the value <code>"none"</code>. If a revocation endpoint is provided, this property should also be provided with the value <code>["none"]</code>, since the omission of this value defaults to <code>client_secret_basic</code> according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>].</li>
              <li id="indieauth-server-metadata-li-8"><code>scopes_supported</code> (recommended) - JSON array containing scope values supported by the IndieAuth server. Servers <em class="rfc2119" title="MAY">MAY</em> choose not to advertise some supported scope values even when this parameter is used.</li>
              <li id="indieauth-server-metadata-li-9"><code>response_types_supported</code> (optional) - JSON array containing the response_type values supported. This differs from [RFC8414] in that this parameter is <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> and that, if omitted, the default is <code>code</code></li>
              <li id="indieauth-server-metadata-li-10"><code>grant_types_supported</code> (optional) - JSON array containing grant type values supported. If omitted, the default value differs from [RFC8414] and is <code>authorization_code</code></li>
              <li id="indieauth-server-metadata-li-11"><code>service_documentation</code> (optional) - URL of a page containing human-readable information that developers might need to know when using the server. This might be a link to the IndieAuth spec or something more personal to your implementation.
              </li><li id="indieauth-server-metadata-li-12"><code>code_challenge_methods_supported</code> - JSON array containing the methods supported for PKCE. This parameter differs from [RFC8414] in that it is not optional as PKCE is <em class="rfc2119" title="REQUIRED">REQUIRED</em>.</li>
              <li id="indieauth-server-metadata-li-13"><code>authorization_response_iss_parameter_supported</code> (optional) - Boolean parameter indicating whether the authorization server provides the <code>iss</code> parameter. If omitted, the default value is false. As the <code>iss</code> parameter is <em class="rfc2119" title="REQUIRED">REQUIRED</em>, this is provided for compatibility with OAuth 2.0 servers implementing the parameter.</li>
              <li id="indieauth-server-metadata-li-14"><code>userinfo_endpoint</code> (optional) - The User Info Endpoint</li>
            </ul>

        <div class="example" id="example-1">
        <div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "issuer": "https://indieauth.example.com/",
  "authorization_endpoint": "https://indieauth.example.com/auth",
  "token_endpoint": "https://indieauth.example.com/token",
  "code_challenge_methods_supported": ["S256"]
}</pre>
      </div>

         </section>

      </section>

      <section id="client-information-discovery">
        <h3 id="x4-2-client-information-discovery"><bdi class="secno">4.2 </bdi>Client Information Discovery<a class="self-link" aria-label="§" href="#client-information-discovery"></a></h3>

        <p id="client-information-discovery-p-1">When an authorization server presents its <a href="https://www.oauth.com/oauth2-servers/authorization/the-authorization-interface/">authorization interface</a>, it will often want to display some additional information about the client beyond just the <code>client_id</code> URL, in order to better inform the user about the request being made. Additionally, the authorization server needs to know the list of redirect URLs that the client is allowed to redirect to.</p>

        <p id="client-information-discovery-p-2">Clients <em class="rfc2119" title="SHOULD">SHOULD</em> publish an OAuth Client ID Metadata Document [<cite><a class="bibref" data-link-type="biblio" href="#bib-clientidmetadatadocument" title="OAuth Client ID Metadata Document">ClientIDMetadataDocument</a></cite>] at the client identifier URL.</p>

        <p id="client-information-discovery-p-3">The authorization server <em class="rfc2119" title="SHOULD">SHOULD</em> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fetch" title="Fetch Standard">Fetch</a></cite>] the URL to find more information about the client.</p>

        <p id="client-information-discovery-p-4">If the <code>client_id</code> contains the permitted IPv4 and IPv6 addresses <code>127.0.0.1</code> or <code>[::1]</code>, or if the domain name resolves to these addresses, the authorization endpoint <em class="rfc2119" title="MUST NOT">MUST NOT</em> fetch the <code>client_id</code>.</p>

        <p id="client-information-discovery-p-5">Note that the server may want to perform some additional checks on the <code>client_id</code> before fetching it to avoid SSRF attacks. In particular, the server may want to resolve the domain name first and avoid fetching the document if the IP address is within the loopback range defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5735" title="Special Use IPv4 Addresses">RFC5735</a></cite>] or any other implementation-specific internal IP address.</p>

        <section id="client-metadata">
          <h4 id="x4-2-1-client-metadata"><bdi class="secno">4.2.1 </bdi>Client Metadata<a class="self-link" aria-label="§" href="#client-metadata"></a></h4>

          <p class="advisement" id="client-metadata-p-1">This section is based on [<cite><a class="bibref" data-link-type="biblio" href="#bib-clientidmetadatadocument" title="OAuth Client ID Metadata Document">ClientIDMetadataDocument</a></cite>], and is included here for convenience, but the normative requirements in [<cite><a class="bibref" data-link-type="biblio" href="#bib-clientidmetadatadocument" title="OAuth Client ID Metadata Document">ClientIDMetadataDocument</a></cite>] take precedence.</p>

          <p id="client-metadata-p-2">Clients <em class="rfc2119" title="SHOULD">SHOULD</em> have a JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC7159</a></cite>] document at their <code>client_id</code> URL containing client metadata defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7591" title="OAuth 2.0 Dynamic Client Registration Protocol">RFC7591</a></cite>], the minimum properties for an IndieAuth client defined below. The authorization server <em class="rfc2119" title="MAY">MAY</em> cache the client metadata it discovers at the client ID URL and <em class="rfc2119" title="SHOULD">SHOULD</em> respect cache-control headers and set reasonable defaults if none are present.</p>

          <ul>
            <li id="client-metadata-li-1"><code>client_id</code> - the client identifier. The authorization server <em class="rfc2119" title="MUST">MUST</em> verify that the <code>client_id</code> in the document matches the <code>client_id</code> of the URL where the document was retrieved. The <code>client_uri</code> <em class="rfc2119" title="MUST">MUST</em> be a prefix of the <code>client_id</code>.</li>
            <li id="client-metadata-li-2"><code>client_name</code> - (optional) Human readable name of the client to be presented on the consent screen</li>
            <li id="client-metadata-li-3"><code>client_uri</code> - URL of a webpage providing information about the client</li>
            <li id="client-metadata-li-4"><code>logo_uri</code> - (optional) URL that references a logo or icon for the client</li>
            <li id="client-metadata-li-5"><code>redirect_uris</code> - (optional) An array of redirect URIs
          </li></ul>

          <p id="client-metadata-p-3">Additional metadata properties defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-clientmetadata" title="OAuth Dynamic Client Registration Metadata">ClientMetadata</a></cite>] <em class="rfc2119" title="MAY">MAY</em> be added, with the understanding that some authorization servers may not recognize them.</p>

          <p id="client-metadata-p-4">Clients <em class="rfc2119" title="SHOULD">SHOULD</em> have a web page at their <code>client_uri</code> URL with basic information about the application, at least the application's name and icon. Authorization servers <em class="rfc2119" title="SHOULD">SHOULD</em> display this URL to the user during authorization, so that the user can learn more about the application. Authorization servers <em class="rfc2119" title="SHOULD">SHOULD</em> warn the user if the hostname of the <code>client_uri</code> is different from the hostname of the <code>client_id</code>.</p>

          <p id="client-metadata-p-5">Note: Earlier versions of this specification recommended an HTML document with <a href="https://microformats.org/wiki/h-app"><code>h-app</code></a> Microformats as the <code>client_id</code>, and authorization servers may wish to continue to support this for backwards compatibility.</p>

        </section>

        <section id="redirect-url">
          <h4 id="x4-2-2-redirect-url"><bdi class="secno">4.2.2 </bdi>Redirect URL<a class="self-link" aria-label="§" href="#redirect-url"></a></h4>

          <p id="redirect-url-p-1">If a client wishes to use a redirect URL that has a different host than their <code>client_id</code>, or if the redirect URL uses a custom scheme (such as when the client is a native application), then the client will need to explicitly list those redirect URLs in the <code>redirect_uri</code> property of the client metadata so that authorization endpoints can be sure it is safe to redirect users there. Authorization endpoints verifying that a <code>redirect_uri</code> is allowed for use by a client <em class="rfc2119" title="MUST">MUST</em> look for an exact match of the given <code>redirect_uri</code> in the request against the list of <code>redirect_uri</code>s after resolving any relative URLs.</p>
         <p id="redirect-url-p-2">When a client chooses to serve a web page as its client_id, the client <em class="rfc2119" title="MAY">MAY</em> publish one or more <code>&lt;link&gt;</code> tags or <code>Link</code> HTTP headers with a <code>rel</code> attribute of <code>redirect_uri</code> at the <code>client_id</code> URL to be used by the authorization server.</p>

          <div class="example" id="example-2">
        <div class="marker">
    <a class="self-link" href="#example-2">Example<bdi> 2</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>app.example.com

<span class="http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> Ok
<span class="hljs-attribute">Content-type</span><span class="hljs-punctuation">: </span>text/html; charset=utf-8
<span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;https://app.example.com/redirect&gt;; rel="redirect_uri"

<span class="xml"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"redirect_uri"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/redirect"</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  ...
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></span></code></pre>
      </div>
        </section>

      </section>

    </section>

    <section class="normative" id="authorization">
      <h2 id="x5-authorization"><bdi class="secno">5. </bdi>Authorization<a class="self-link" aria-label="§" href="#authorization"></a></h2>

      <p id="authorization-p-1">This section describes how to authenticate users and optionally obtain an access token using the OAuth 2.0 Authorization Code Flow with IndieAuth.</p>


      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1382 1060" style="width: 100%; height: auto;"><defs></defs><g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g><rect fill="white" stroke="none" x="0" y="0" width="1382" height="1060"></rect></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="574.030346186636" y="26.3876361" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IndieAuth&nbsp;Flow&nbsp;Diagram</text></g><g><g><path fill="lightgrey" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 77.13985619900001 L 118.32693215311718 77.13985619900001 L 118.32693215311718 1051.4593397979995 L 8.7958787 1051.4593397979995 L 8.7958787 77.13985619900001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path></g><g></g><g><path fill="lightgrey" stroke="black" paint-order="fill stroke markers" d=" M 372.0653335664674 77.13985619900001 L 465.3115054277878 77.13985619900001 L 465.3115054277878 1051.4593397979995 L 372.0653335664674 1051.4593397979995 L 372.0653335664674 77.13985619900001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path></g><g></g><g><path fill="lightgrey" stroke="black" paint-order="fill stroke markers" d=" M 666.8523818167239 77.13985619900001 L 797.5716982092943 77.13985619900001 L 797.5716982092943 1051.4593397979995 L 666.8523818167239 1051.4593397979995 L 666.8523818167239 77.13985619900001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path></g><g></g><g><path fill="lightgrey" stroke="black" paint-order="fill stroke markers" d=" M 863.6311717465377 54.270571579000006 L 1374.035321485772 54.270571579000006 L 1374.035321485772 1051.4593397979995 L 863.6311717465377 1051.4593397979995 L 863.6311717465377 54.270571579000006" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1046.743059543401" y="78.899031939" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization&nbsp;Server</text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.56140542655859 143.72465795799997 L 63.56140542655859 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 143.72465795799997 L 418.6884194971276 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 732.2120400130091 143.72465795799997 L 732.2120400130091 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 938.7760930043463 143.72465795799997 L 938.7760930043463 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1115.5619682348072 143.72465795799997 L 1115.5619682348072 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1295.6191218466158 143.72465795799997 L 1295.6191218466158 1051.4593397979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"></path></g><g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 17.5917574 96.226912978 L 109.53105345311718 96.226912978 L 109.53105345311718 143.724657958 L 17.5917574 143.724657958 L 17.5917574 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="36.678814179" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 380.8612122664674 96.226912978 L 456.5156267277877 96.226912978 L 456.5156267277877 143.724657958 L 380.8612122664674 143.724657958 L 380.8612122664674 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="399.94826904546744" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 675.6482605167239 96.226912978 L 788.7758195092943 96.226912978 L 788.7758195092943 143.724657958 L 675.6482605167239 143.724657958 L 675.6482605167239 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.7353172957239" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Profile&nbsp;URL</text></g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 872.4270504465377 96.226912978 L 1005.1251355621549 96.226912978 L 1005.1251355621549 143.724657958 L 872.4270504465377 143.724657958 L 872.4270504465377 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="891.5141072255377" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Metadata&nbsp;URL</text></g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1022.7168929621548 96.226912978 L 1208.4070435074595 96.226912978 L 1208.4070435074595 143.724657958 L 1022.7168929621548 143.724657958 L 1022.7168929621548 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1041.8039497411548" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization&nbsp;Endpoint</text></g><path fill="none" stroke="none"></path><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1225.9988009074596 96.226912978 L 1365.239442785772 96.226912978 L 1365.239442785772 143.724657958 L 1225.9988009074596 143.724657958 L 1225.9988009074596 96.226912978 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""></path></g><g><g></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1245.0858576864596" y="126.13290055799999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Token&nbsp;Endpoint</text></g></g><g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.0454980941673" y="194.740754418" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;User&nbsp;enters&nbsp;a&nbsp;URL,&nbsp;and&nbsp;the</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.0454980941673" y="194.740754418" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;User&nbsp;enters&nbsp;a&nbsp;URL,&nbsp;and&nbsp;the</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.0454980941673" y="212.332511818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">client&nbsp;canonicalizes&nbsp;the&nbsp;URL</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.0454980941673" y="212.332511818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client&nbsp;canonicalizes&nbsp;the&nbsp;URL</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.56140542655859 219.36921477799996 L 404.2045392377943 219.36921477799996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(418.6884194971276,219.36921477799996) translate(-418.6884194971276,-219.36921477799996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 404.02862166379424 212.03931586133328 L 418.6884194971276 219.36921477799996 L 404.02862166379424 226.69911369466664 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="474.8239251286035" y="261.589432538" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;fetches&nbsp;URL&nbsp;to&nbsp;discover</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="474.8239251286035" y="261.589432538" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;fetches&nbsp;URL&nbsp;to&nbsp;discover</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="474.8239251286035" y="279.181189938" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">rel=indieauth-metadata</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="474.8239251286035" y="279.181189938" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">rel=indieauth-metadata</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 286.21789289799995 L 717.7281597536758 286.21789289799995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(732.2120400130091,286.21789289799995) translate(-732.2120400130091,-286.21789289799995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 717.5522421796758 278.8879939813333 L 732.2120400130091 286.21789289799995 L 717.5522421796758 293.5477918146666 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.9835379890183" y="328.43811065799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;fetches&nbsp;metadata&nbsp;URL&nbsp;to&nbsp;find</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.9835379890183" y="328.43811065799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;fetches&nbsp;metadata&nbsp;URL&nbsp;to&nbsp;find</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="560.9835379890183" y="346.029868058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">authorization_endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="560.9835379890183" y="346.029868058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authorization_endpoint</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.9835379890183" y="363.621625458" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">and&nbsp;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.9835379890183" y="363.621625458" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and&nbsp;</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="589.5161002448776" y="363.621625458" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">token_endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="589.5161002448776" y="363.621625458" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">token_endpoint</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 370.65832841799994 L 924.292212745013 370.65832841799994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(938.7760930043463,370.65832841799994) translate(-938.7760930043463,-370.65832841799994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 924.116295171013 363.3284295013333 L 938.7760930043463 370.65832841799994 L 924.116295171013 377.9882273346666 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="114.3998453231712" y="412.87854617799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;builds&nbsp;authorization&nbsp;request&nbsp;and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="114.3998453231712" y="412.87854617799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;builds&nbsp;authorization&nbsp;request&nbsp;and</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="114.3998453231712" y="430.47030357799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">redirects&nbsp;to&nbsp;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="114.3998453231712" y="430.47030357799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">redirects&nbsp;to&nbsp;</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="190.9853403182884" y="430.47030357799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">authorization_endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="190.9853403182884" y="430.47030357799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authorization_endpoint</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 437.5070065379999 L 78.04528568589193 437.5070065379999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"></path><g transform="translate(63.56140542655859,437.5070065379999) translate(-63.56140542655859,-437.5070065379999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 78.22120325989192 430.1771076213333 L 63.56140542655859 437.5070065379999 L 78.22120325989192 444.8369054546666 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="348.7529252340032" y="479.72722429799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;User&nbsp;visits&nbsp;their&nbsp;authorization&nbsp;endpoint&nbsp;and&nbsp;sees&nbsp;the&nbsp;authorization&nbsp;request</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="348.7529252340032" y="479.72722429799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;User&nbsp;visits&nbsp;their&nbsp;authorization&nbsp;endpoint&nbsp;and&nbsp;sees&nbsp;the&nbsp;authorization&nbsp;request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.56140542655859 486.7639272579999 L 1101.0780879754739 486.7639272579999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(1115.5619682348072,486.7639272579999) translate(-1115.5619682348072,-486.7639272579999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1100.9021704014738 479.43402834133326 L 1115.5619682348072 486.7639272579999 L 1100.9021704014738 494.09382617466656 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="566.2555649597174" y="528.9841450179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Authorization&nbsp;endpoint&nbsp;fetches&nbsp;client&nbsp;information&nbsp;(name,&nbsp;icon)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="566.2555649597174" y="528.9841450179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Authorization&nbsp;endpoint&nbsp;fetches&nbsp;client&nbsp;information&nbsp;(name,&nbsp;icon)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1115.5619682348072 536.0208479779999 L 433.1722997564609 536.0208479779999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(418.6884194971276,536.0208479779999) translate(-418.6884194971276,-536.0208479779999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 433.34821733046095 528.6909490613332 L 418.6884194971276 536.0208479779999 L 433.34821733046095 543.3507468946666 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.12729962365165" y="578.2410657379997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;User&nbsp;authenticates,&nbsp;and&nbsp;approves&nbsp;the&nbsp;request.&nbsp;Authorization</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.12729962365165" y="578.2410657379997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;User&nbsp;authenticates,&nbsp;and&nbsp;approves&nbsp;the&nbsp;request.&nbsp;Authorization</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.12729962365165" y="595.8328231379998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">endpoint&nbsp;issues&nbsp;authorization&nbsp;code,&nbsp;builds&nbsp;redirect&nbsp;back&nbsp;to&nbsp;client.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.12729962365165" y="595.8328231379998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">endpoint&nbsp;issues&nbsp;authorization&nbsp;code,&nbsp;builds&nbsp;redirect&nbsp;back&nbsp;to&nbsp;client.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1115.5619682348072 602.8695260979998 L 78.04528568589193 602.8695260979998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"></path><g transform="translate(63.56140542655859,602.8695260979998) translate(-63.56140542655859,-602.8695260979998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 78.22120325989192 595.5396271813331 L 63.56140542655859 602.8695260979998 L 78.22120325989192 610.1994250146665 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="131.5579950424095" y="645.0897438579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;User's&nbsp;browser&nbsp;is&nbsp;redirected&nbsp;to</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="131.5579950424095" y="645.0897438579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;User's&nbsp;browser&nbsp;is&nbsp;redirected&nbsp;to</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="131.5579950424095" y="662.6815012579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">client&nbsp;with&nbsp;an&nbsp;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="131.5579950424095" y="662.6815012579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client&nbsp;with&nbsp;an&nbsp;</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="220.37685795744855" y="662.6815012579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">authorization&nbsp;code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="220.37685795744855" y="662.6815012579997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authorization&nbsp;code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.56140542655859 669.7182042179998 L 404.2045392377943 669.7182042179998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(418.6884194971276,669.7182042179998) translate(-418.6884194971276,-669.7182042179998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 404.02862166379424 662.388305301333 L 418.6884194971276 669.7182042179998 L 404.02862166379424 677.0481031346665 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="711.9384219779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;exchanges&nbsp;authorization&nbsp;code&nbsp;for&nbsp;an&nbsp;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="711.9384219779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;exchanges&nbsp;authorization&nbsp;code&nbsp;for&nbsp;an&nbsp;</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="729.5301793779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">access&nbsp;token&nbsp;by&nbsp;making&nbsp;a&nbsp;POST&nbsp;request</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="729.5301793779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">access&nbsp;token&nbsp;by&nbsp;making&nbsp;a&nbsp;POST&nbsp;request</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="747.1219367779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">to&nbsp;the&nbsp;token_endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="714.1294786796842" y="747.1219367779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to&nbsp;the&nbsp;token_endpoint</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 754.1586397379997 L 1281.1352415872825 754.1586397379997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(1295.6191218466158,754.1586397379997) translate(-1295.6191218466158,-754.1586397379997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1280.9593240132824 746.828740821333 L 1295.6191218466158 754.1586397379997 L 1280.9593240132824 761.4885386546664 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="701.1087572441373" y="796.3788574979995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Token&nbsp;endpoint&nbsp;verifies&nbsp;code&nbsp;and&nbsp;returns</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="701.1087572441373" y="796.3788574979995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Token&nbsp;endpoint&nbsp;verifies&nbsp;code&nbsp;and&nbsp;returns</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="701.1087572441373" y="813.9706148979996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">canonical&nbsp;user&nbsp;profile&nbsp;URL&nbsp;with&nbsp;an&nbsp;access&nbsp;token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="701.1087572441373" y="813.9706148979996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">canonical&nbsp;user&nbsp;profile&nbsp;URL&nbsp;with&nbsp;an&nbsp;access&nbsp;token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1295.6191218466158 821.0073178579996 L 433.1722997564609 821.0073178579996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"></path><g transform="translate(418.6884194971276,821.0073178579996) translate(-418.6884194971276,-821.0073178579996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 433.34821733046095 813.6774189413329 L 418.6884194971276 821.0073178579996 L 433.34821733046095 828.3372167746663 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="863.2275356179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;fetches&nbsp;the&nbsp;user&nbsp;URL</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="863.2275356179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;fetches&nbsp;the&nbsp;user&nbsp;URL</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="880.8192930179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">if&nbsp;it&nbsp;differs&nbsp;from&nbsp;the&nbsp;original,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="880.8192930179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if&nbsp;it&nbsp;differs&nbsp;from&nbsp;the&nbsp;original,</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="898.4110504179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">and&nbsp;confirms&nbsp;the&nbsp;it&nbsp;declares</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="898.4110504179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and&nbsp;confirms&nbsp;the&nbsp;it&nbsp;declares</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="916.0028078179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">the&nbsp;same&nbsp;authorization&nbsp;server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.8897896915918" y="916.0028078179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the&nbsp;same&nbsp;authorization&nbsp;server</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 923.0395107779996 L 717.7281597536758 923.0395107779996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""></path><g transform="translate(732.2120400130091,923.0395107779996) translate(-732.2120400130091,-923.0395107779996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 717.5522421796758 915.7096118613329 L 732.2120400130091 923.0395107779996 L 717.5522421796758 930.3694096946663 Z"></path></g></g><g><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.04550572356183" y="965.2597285379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">&nbsp;Client&nbsp;initiates&nbsp;login&nbsp;session</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.04550572356183" y="965.2597285379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&nbsp;Client&nbsp;initiates&nbsp;login&nbsp;session</text><text fill="none" stroke="white" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.04550572356183" y="982.8514859379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve" stroke-miterlimit="2" stroke-width="6.5969090249999995" stroke-dasharray="">and&nbsp;the&nbsp;user&nbsp;is&nbsp;logged&nbsp;in</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.04550572356183" y="982.8514859379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and&nbsp;the&nbsp;user&nbsp;is&nbsp;logged&nbsp;in</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 418.6884194971276 989.8881888979995 L 78.04528568589193 989.8881888979995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"></path><g transform="translate(63.56140542655859,989.8881888979995) translate(-63.56140542655859,-989.8881888979995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 78.22120325989192 982.5582899813328 L 63.56140542655859 989.8881888979995 L 78.22120325989192 997.2180878146662 Z"></path></g></g></g><g></g><g></g><g></g><g></g><g></g><g></g></g></svg>

      <ul>
        <li id="authorization-li-1">The End-User enters a URL in the login form of the client and clicks "Sign in". The client canonicalizes the URL.</li>
        <li id="authorization-li-2">The client discovers the End-User's IndieAuth server metadata endpoint by fetching the provided URL and looking for the <code>rel=indieauth-metadata</code> value</li>
        <li id="authorization-li-3">The client discovers the server's authorization endpoint and token endpoint by fetching the metadata URL and looking for the <code>authorization_endpoint</code> and <code>token_endpoint</code> values</li>
        <li id="authorization-li-4">The client builds the authorization request including its client identifier, requested scope, local state, and a redirect URI, and redirects the browser to the authorization endpoint</li>
        <li id="authorization-li-5">The authorization endpoint fetches the client information from the client identifier URL in order to have an application name and icon to display to the user</li>
        <li id="authorization-li-6">The authorization endpoint verifies the End-User, e.g. by logging in, and establishes whether the End-User grants or denies the client's request</li>
        <li id="authorization-li-7">The authorization endpoint generates an authorization code and redirects the browser back to the client, including an authorization code in the URL</li>
        <li id="authorization-li-8">The client exchanges the authorization code for an access token by making a POST request to the token endpoint. The token endpoint validates the authorization code, and responds with the End-User's canonical profile URL and an access token</li>
        <li id="authorization-li-9">The client confirms the returned profile URL declares the same authorization server and accepts the profile URL</li>
      </ul>

      <p id="authorization-p-2">Note: If the client is only trying to learn who the user is and does not need an access token, the client exchanges the authorization code for the user profile information at the Authorization Endpoint instead.</p>

      <section id="discovery-0">
        <h3 id="x5-1-discovery"><bdi class="secno">5.1 </bdi>Discovery<a class="self-link" aria-label="§" href="#discovery-0"></a></h3>

        <p id="discovery-0-p-1">After obtaining a URL from the End-User, and optionally applying <a href="url-canonicalization">URL Canonicalization</a> to it, the client fetches the URL and looks for the <code>indieauth-metadata</code> rel values in the HTTP <code>Link</code> headers and HTML <code>&lt;link&gt;</code> tags as described in <a href="#discovery-by-clients" class="sec-ref">§&nbsp;<bdi class="secno">4.1 </bdi>Discovery by Clients</a>.</p>

        <div class="example" id="example-3">
        <div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div> <pre class="nohighlight">Link: &lt;https://indieauth.example.com/.well-known/oauth-authorization-server&gt;; rel="indieauth-metadata"

&lt;link rel="indieauth-metadata" href="https://indieauth.example.com/.well-known/oauth-authorization-server"&gt;</pre>
      </div>

        <p id="discovery-0-p-2">The client fetches the metadata document and finds the <code>authorization_endpoint</code> and <code>token_endpoint</code> in the JSON body.</p>

        <div class="example" id="example-4">
        <div class="marker">
    <a class="self-link" href="#example-4">Example<bdi> 4</bdi></a>
  </div> <pre class="nohighlight">{
  "issuer": "https://indieauth.example.com/",
  "authorization_endpoint": "https://indieauth.example.com/auth",
  "token_endpoint": "https://indieauth.example.com/token",
  "code_challenge_methods_supported": ["S256"]
}</pre>
      </div>

      </section>

      <section id="authorization-request">
        <h3 id="x5-2-authorization-request"><bdi class="secno">5.2 </bdi>Authorization Request<a class="self-link" aria-label="§" href="#authorization-request"></a></h3>

          <p id="authorization-request-p-1">The client builds the authorization request URL by starting with the discovered <code>authorization_endpoint</code> URL and adding parameters to the query component.</p>

          <p id="authorization-request-p-2">All IndieAuth clients <em class="rfc2119" title="MUST">MUST</em> use PKCE ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>]) to protect against authorization code injection and CSRF attacks. A non-canonical description of the PKCE mechanism is described below, but implementers should refer to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>] for details.</p>

          <p id="authorization-request-p-3">Clients use a unique secret per authorization request to protect against authorization code injection and CSRF attacks. The client first generates this secret, which it can later use along with the authorization code to prove that the application using the authorization code is the same application that requested it.</p>

          <p id="authorization-request-p-4">The client first creates a code verifier for each authorization request by generating a random string using the characters <code>[A-Z] / [a-z] / [0-9] / - / . / _ / ~</code> with a minimum length of 43 characters and maximum length of 128 characters. This value is stored on the client and will be used in the authorization code exchange step later.</p>

          <p id="authorization-request-p-5">The client then creates the code challenge derived from the code verifier by calculating the SHA256 hash of the code verifier and <a href="https://datatracker.ietf.org/doc/html/rfc7636#appendix-A">Base64-URL-encoding</a> the result.</p>

          <code>code_challenge = BASE64URL-ENCODE(SHA256(ASCII(code_verifier)))</code>

          <p id="authorization-request-p-6">For backwards compatibility, authorization endpoints <em class="rfc2119" title="MAY">MAY</em> accept authorization requests without a code challenge if the authorization server wishes to support older clients.</p>

          <ul>
            <li id="authorization-request-li-1"><code>response_type=code</code> - Indicates to the authorization server that an authorization code should be returned as the response</li>
            <li id="authorization-request-li-2"><code>client_id</code> - The client URL</li>
            <li id="authorization-request-li-3"><code>redirect_uri</code> - The redirect URL indicating where the user should be redirected to after approving the request</li>
            <li id="authorization-request-li-4"><code>state</code> - A parameter set by the client which will be included when the user is redirected back to the client. This is used to prevent CSRF attacks. The authorization server <em class="rfc2119" title="MUST">MUST</em> return the unmodified state value back to the client.</li>
            <li id="authorization-request-li-5"><code>code_challenge</code> - The code challenge as previously described.</li>
            <li id="authorization-request-li-6"><code>code_challenge_method</code> - The hashing method used to calculate the code challenge, e.g. "S256"</li>
            <li id="authorization-request-li-7"><code>scope</code> - (optional) A space-separated list of scopes the client is requesting, e.g. "profile", or "profile create". If the client omits this value, the authorization server <em class="rfc2119" title="MUST NOT">MUST NOT</em> issue an access token for this authorization code. Only the user's profile URL may be returned without any scope requested. See <a href="#profile-information">Profile Information</a> for details about which scopes to request to return user profile information.</li>
            <li id="authorization-request-li-8"><code>me</code> - (optional) The URL that the user entered</li>
          </ul>

          <div class="example" id="example-5">
        <div class="marker">
    <a class="self-link" href="#example-5">Example<bdi> 5</bdi></a>
  </div> <pre class="nohighlight">https://example.org/auth?response_type=code&amp;
                         client_id=https://app.example.com/&amp;
                         redirect_uri=https://app.example.com/redirect&amp;
                         state=1234567890&amp;
                         code_challenge=OfYAxt8zU2dAPDWQxTAUIteRzMsoj9QBdMIVEDOErUo&amp;
                         code_challenge_method=S256&amp;
                         scope=profile+create+update+delete&amp;
                         me=https://user.example.net/</pre>
      </div>

          <p id="authorization-request-p-7">The client <em class="rfc2119" title="SHOULD">SHOULD</em> provide the <code>me</code> query string parameter to the authorization endpoint, either the exact value the user entered, or the value after applying <a href="url-canonicalization">URL Canonicalization</a>.</p>

          <p id="authorization-request-p-8">The authorization endpoint <em class="rfc2119" title="SHOULD">SHOULD</em> fetch the <code>client_id</code> URL to retrieve application information and the client's registered redirect URLs, see <a href="#client-information-discovery">Client Information Discovery</a> for more information.</p>

          <p id="authorization-request-p-9">If the URL scheme, host or port of the <code>redirect_uri</code> in the request do not match that of the <code>client_id</code>, then the authorization endpoint <em class="rfc2119" title="SHOULD">SHOULD</em> verify that the requested <code>redirect_uri</code> matches one of the <a href="#redirect-url">redirect URLs</a> published by the client, and <em class="rfc2119" title="SHOULD">SHOULD</em> block the request from proceeding if not.</p>

          <p id="authorization-request-p-10">It is up to the authorization endpoint how to authenticate the user. This step is out of scope of OAuth 2.0, and is highly dependent on the particular implementation. Some authorization servers use typical username/password authentication, and others use alternative forms of authentication such as [<cite><a class="bibref" data-link-type="biblio" href="#bib-relmeauth" title="RelMeAuth">RelMeAuth</a></cite>], or delegate to other identity providers.</p>

          <p id="authorization-request-p-11">The authorization endpoint <em class="rfc2119" title="MAY">MAY</em> use the provided <code>me</code> query component as a hint of which user is attempting to sign in, and to indicate which profile URL the client is expecting in the resulting profile URL response or access token response. This is specifically helpful for authorization endpoints where users have multiple supported profile URLs, so the authorization endpoint can make an informed decision as to which profile URL the user meant to identify as. Note that from the authorization endpoint's view, this value as provided by the client is unverified external data and <em class="rfc2119" title="MUST NOT">MUST NOT</em> be assumed to be valid data at this stage. If the logged-in user doesn't match the provided <code>me</code> parameter by the client, the authorization endpoint <em class="rfc2119" title="MAY">MAY</em> either ignore the <code>me</code> parameter completely or display an error, at the authorization endpoint's discretion.</p>

          <p id="authorization-request-p-12">Once the user is authenticated, the authorization endpoint presents the authorization request to the user. The prompt <em class="rfc2119" title="MUST">MUST</em> indicate which application the user is signing in to, and <em class="rfc2119" title="SHOULD">SHOULD</em> provide as much detail as possible about the request, such as information about the requested scopes.</p>

        <section id="authorization-response">
          <h4 id="x5-2-1-authorization-response"><bdi class="secno">5.2.1 </bdi>Authorization Response<a class="self-link" aria-label="§" href="#authorization-response"></a></h4>

          <p id="authorization-response-p-1">If the user approves the request, the authorization endpoint generates an authorization code and builds the redirect back to the client.</p>

          <p id="authorization-response-p-2">The redirect is built by starting with the <code>redirect_uri</code> in the request, and adding the following parameters to the query component of the redirect URL:</p>

          <ul>
            <li id="authorization-response-li-1"><code>code</code> - The authorization code generated by the authorization endpoint. The code <em class="rfc2119" title="MUST">MUST</em> expire shortly after it is issued to mitigate the risk of leaks, and <em class="rfc2119" title="MUST">MUST</em> be valid for only one use. A maximum lifetime of 10 minutes is recommended. See <a href="https://tools.ietf.org/html/rfc6749#section-4.1.2">OAuth 2.0 Section 4.1.2</a> for additional requirements on the authorization code.</li>
            <li id="authorization-response-li-2"><code>state</code> - The state parameter <em class="rfc2119" title="MUST">MUST</em> be set to the exact value that the client set in the request.</li>
            <li id="authorization-response-li-3"><code>iss</code> - The issuer identifier for client validation.</li>
          </ul>

          <div class="example" id="example-6">
        <div class="marker">
    <a class="self-link" href="#example-6">Example<bdi> 6</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 302 Found
Location: https://app.example.com/redirect?code=xxxxxxxx&amp;
                                           state=1234567890&amp;
                                           iss=https%3A%2F%2Findieauth.example.com</pre>
      </div>

          <p id="authorization-response-p-3">Upon the redirect back to the client, the client <em class="rfc2119" title="MUST">MUST</em> verify:</p>

	  <ul>
	    <li id="authorization-response-li-4">That the <code>state</code> parameter in the request is valid and matches the state parameter that it initially created, in order to prevent CSRF attacks. The state value can also store session information to enable development of clients that cannot store data themselves.</li>
	    <li id="authorization-response-li-5">That the <code>iss</code> parameter in the request is valid and matches the issuer parameter provided by the Server Metadata endpoint during Discovery as outlined in OAuth 2.0 Authorization Server Issuer Identification[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9207" title="OAuth 2.0 Authorization Server Issuer Identification">RFC9207</a></cite>]. Clients <em class="rfc2119" title="MUST">MUST</em> compare the parameters using simple string comparison. If the value does not match the expected issuer identifier, clients <em class="rfc2119" title="MUST">MUST</em> reject the authorization response and <em class="rfc2119" title="MUST NOT">MUST NOT</em> proceed with the authorization grant. For error responses, clients <em class="rfc2119" title="MUST NOT">MUST NOT</em> assume that the error originates from the intended authorization server. </li>
	  </ul>

          <p id="authorization-response-p-4">See OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] <a href="https://tools.ietf.org/html/rfc6749#section-4.1.2.1">Section 4.1.2.1</a> for how to indicate errors and other failures to the user and client.</p>
        </section>
      </section>

      <section id="redeeming-the-authorization-code">
        <h3 id="x5-3-redeeming-the-authorization-code"><bdi class="secno">5.3 </bdi>Redeeming the Authorization Code<a class="self-link" aria-label="§" href="#redeeming-the-authorization-code"></a></h3>

        <p id="redeeming-the-authorization-code-p-1">Once the client has obtained an authorization code, it can redeem it for an access token or the user's final profile URL.</p>

        <section id="request">
          <h4 id="x5-3-1-request"><bdi class="secno">5.3.1 </bdi>Request<a class="self-link" aria-label="§" href="#request"></a></h4>

          <p id="request-p-1">If the client needs an access token in order to make requests to a resource server such as a [<cite><a class="bibref" data-link-type="biblio" href="#bib-micropub" title="Micropub">Micropub</a></cite>] endpoint, it can exchange the authorization code for an access token and the user's profile URL at the <b>token endpoint</b>.</p>

          <p id="request-p-2">If the client only needs to know the user who logged in and does not need to make requests to resource servers with an access token, the client exchanges the authorization code for the user's profile URL at the <b>authorization endpoint</b>.</p>

          <p id="request-p-3">After the client validates the state parameter, the client makes a POST request to the token endpoint or authorization endpoint to exchange the authorization code for the final user profile URL and/or access token. The POST request contains the following parameters:</p>

          <ul>
            <li id="request-li-1"><code>grant_type=authorization_code</code></li>
            <li id="request-li-2"><code>code</code> - The authorization code received from the authorization endpoint in the redirect.</li>
            <li id="request-li-3"><code>client_id</code> - The client's URL, which <em class="rfc2119" title="MUST">MUST</em> match the client_id used in the authentication request.</li>
            <li id="request-li-4"><code>redirect_uri</code> - The client's redirect URL, which <em class="rfc2119" title="MUST">MUST</em> match the initial authentication request.</li>
            <li id="request-li-5"><code>code_verifier</code> - The original plaintext random string generated before starting the authorization request.</li>
          </ul>

          <b>Example request to authorization endpoint</b>
          <div class="example" id="example-7">
        <div class="marker">
    <a class="self-link" href="#example-7">Example<bdi> 7</bdi></a>
  </div> <pre class="nohighlight">POST https://indieauth.example.com/auth
Content-type: application/x-www-form-urlencoded
Accept: application/json

grant_type=authorization_code
&amp;code=xxxxxxxx
&amp;client_id=https://app.example.com/
&amp;redirect_uri=https://app.example.com/redirect
&amp;code_verifier=a6128783714cfda1d388e2e98b6ae8221ac31aca31959e59512c59f5</pre>
      </div>

          <b>Example request to token endpoint</b>
          <div class="example" id="example-8">
        <div class="marker">
    <a class="self-link" href="#example-8">Example<bdi> 8</bdi></a>
  </div> <pre class="nohighlight">POST https://indieauth.example.com/token
Content-type: application/x-www-form-urlencoded
Accept: application/json

grant_type=authorization_code
&amp;code=xxxxxxxx
&amp;client_id=https://app.example.com/
&amp;redirect_uri=https://app.example.com/redirect
&amp;code_verifier=a6128783714cfda1d388e2e98b6ae8221ac31aca31959e59512c59f5</pre>
      </div>
        </section>

          <p id="redeeming-the-authorization-code-p-5">Note that for backwards compatibility, the authorization endpoint <em class="rfc2119" title="MAY">MAY</em> allow requests without the <code>code_verifier</code>. If an authorization code was issued with no <code>code_challenge</code> present, then the authorization code exchange <em class="rfc2119" title="MUST NOT">MUST NOT</em> include a <code>code_verifier</code>, and similarly, if an authorization code was issued with a <code>code_challenge</code> present, then the authorization code exchange <em class="rfc2119" title="MUST">MUST</em> include a <code>code_verifier</code>.</p>

        <section id="profile-url-response">
          <h4 id="x5-3-2-profile-url-response"><bdi class="secno">5.3.2 </bdi>Profile URL Response<a class="self-link" aria-label="§" href="#profile-url-response"></a></h4>

          <p id="profile-url-response-p-1">If the client only needs to know the user who logged in, the client will exchange the authorization code at the <b>authorization endpoint</b>, and only the canonical user profile URL and possibly profile information is returned.</p>

          <p id="profile-url-response-p-2">The authorization endpoint verifies that the authorization code is valid, has not yet been used, and that it was issued for the matching <code>client_id</code> and <code>redirect_uri</code>, and checks that the provided <code>code_verifier</code> hashes to the same value as given in the <code>code_challenge</code> in the original authorization request. If the request is valid, then the endpoint responds with a JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC7159</a></cite>] object containing the property <code>me</code>, with the canonical user profile URL for the user who signed in, and optionally the property <code>profile</code> with the user's profile information as defined in <a href="#profile-information">Profile Information</a>.</p>

          <div class="example" id="example-9">
        <div class="marker">
    <a class="self-link" href="#example-9">Example<bdi> 9</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "me": "https://user.example.net/"
}</pre>
      </div>

          <p id="profile-url-response-p-3">The resulting profile URL <em class="rfc2119" title="MAY">MAY</em> be different from the URL provided to the client for discovery. This gives the authorization server an opportunity to canonicalize the user's URL, such as correcting <code>http</code> to <code>https</code>, or adding a path if required. See <a href="#differing-user-profile-urls">Differing User Profile URLs</a> for security considerations client developers should be aware of.</p>

          <p id="profile-url-response-p-4">See OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] <a href="https://tools.ietf.org/html/rfc6749#section-5.2">Section 5.2</a> for how to respond in the case of errors or other failures.</p>
        </section>

        <section id="access-token-response">
          <h4 id="x5-3-3-access-token-response"><bdi class="secno">5.3.3 </bdi>Access Token Response<a class="self-link" aria-label="§" href="#access-token-response"></a></h4>

          <p id="access-token-response-p-1">When the client receives an authorization code that was requested with one or more scopes that will result in an access token being returned, the client will exchange the authorization code at the <b>token endpoint</b>.</p>

          <p id="access-token-response-p-2">The token endpoint needs to verify that the authorization code is valid, and that it was issued for the matching <code>client_id</code> and <code>redirect_uri</code>, contains at least one <code>scope</code>, and checks that the provided <code>code_verifier</code> hashes to the same value as given in the <code>code_challenge</code> in the original authorization request. If the authorization code was issued with no <code>scope</code>, the token endpoint <em class="rfc2119" title="MUST NOT">MUST NOT</em> issue an access token, as empty scopes are invalid per Section 3.3 of OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>].</p>

          <p id="access-token-response-p-3">The specifics of how the token endpoint verifies the authorization code are out of scope of this document, as typically the authorization endpoint and token endpoint are part of the same system and can share storage or another private communication mechanism.</p>

          <p id="access-token-response-p-4">If the request is valid, then the token endpoint can generate an access token and return the appropriate response. The token response is a JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC7159</a></cite>] object containing:</p>

          <ul>
            <li id="access-token-response-li-1"><code>access_token</code> (required) - the OAuth 2.0 Bearer Token [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6750" title="The OAuth 2.0 Authorization Framework: Bearer Token Usage">RFC6750</a></cite>].</li>
            <li id="access-token-response-li-2"><code>me</code> (required) - the canonical user profile URL for the user this access token corresponds to.</li>
            <li id="access-token-response-li-3"><code>profile</code> (optional) - the user's profile information as defined in <a href="#profile-information">Profile Information</a>.</li>
            <li id="access-token-response-li-4"><code>expires_in</code> (recommended) - The lifetime in seconds of the access token.</li>
            <li id="access-token-response-li-5"><code>refresh_token</code> (optional) - The refresh token, which can be used to obtain new access tokens as defined in <a href="#refresh-tokens">Refresh Tokens</a>.</li>
          </ul>

          <p id="access-token-response-p-5">For example:</p>

          <div class="example" id="example-10">
        <div class="marker">
    <a class="self-link" href="#example-10">Example<bdi> 10</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "access_token": "XXXXXX",
  "token_type": "Bearer",
  "scope": "create update delete",
  "me": "https://user.example.net/"
}</pre>
      </div>

          <p id="access-token-response-p-6">The resulting profile URL <em class="rfc2119" title="MAY">MAY</em> be different from the URL provided to the client for discovery. This gives the authorization server an opportunity to canonicalize the user's URL, such as correcting <code>http</code> to <code>https</code>, or adding a path if required. See <a href="#differing-user-profile-urls">Differing User Profile URLs</a> for security considerations client developers should be aware of.</p>

          <p id="access-token-response-p-7">See OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] <a href="https://tools.ietf.org/html/rfc6749#section-5.2">Section 5.2</a> for how to respond in the case of errors or other failures.</p>
        </section>

        <section id="profile-information">
          <h4 id="x5-3-4-profile-information"><bdi class="secno">5.3.4 </bdi>Profile Information<a class="self-link" aria-label="§" href="#profile-information"></a></h4>

          <h5 id="requesting-profile-information">Requesting Profile Information<a class="self-link" aria-label="§" href="#profile-information"></a></h5>

          <p id="profile-information-p-1">If the client would like to request the user's profile information in addition to confirming their profile URL, the client can include one or more scopes in the initial authorization request. The following <code>scope</code> values are defined by this specification to request profile information about the user:</p>

          <ul>
            <li id="profile-information-li-1"><code>profile</code> (required) - This scope requests access to the user's default profile information which include the following properties: <code>name</code>, <code>photo</code>, <code>url</code>.</li>
            <li id="profile-information-li-2"><code>email</code> - This scope requests access to the user's email address in the following property: <code>email</code>.</li>
          </ul>

          <p id="profile-information-p-2">Note that because the <code>profile</code> scope is required when requesting profile information, the <code>email</code> scope cannot be requested on its own and must be requested along with the <code>profile</code> scope if desired.</p><p id="profile-information-p-3">

          </p><p id="profile-information-p-4">When an authorization code is issued with any of the scopes defined above, then the response when exchanging the authorization code <em class="rfc2119" title="MAY">MAY</em> include a new property, <code>profile</code>, alongside the <code>me</code> property in the response from the authorization endpoint or the token endpoint. The <code>profile</code> property is defined as a JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC7159</a></cite>] object with the properties defined by each scope above.</p>

          <p id="profile-information-p-5">For example, a complete response to a request with the scopes <code>profile email create</code>, including an access token and profile information, may look like the following:</p>

          <div class="example" id="example-11">
        <div class="marker">
    <a class="self-link" href="#example-11">Example<bdi> 11</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "access_token": "XXXXXX",
  "token_type": "Bearer",
  "scope": "profile email create",
  "me": "https://user.example.net/",
  "profile": {
    "name": "Example User",
    "url": "https://user.example.net/",
    "photo": "https://user.example.net/photo.jpg",
    "email": "user@example.net"
  }
}</pre>
      </div>

          <p id="profile-information-p-6">As is always the case with OAuth 2.0, there is no guarantee that the scopes the client requests will be granted by the authorization server or the user. The client should not rely on the presence of profile information even when requesting the profile scope. As such, implementing support for returning profile information from the authorization server is entirely optional.</p>

          <p id="profile-information-p-7">The information returned in the <code>profile</code> object is informational, and there is no guarantee that this information is "real" or "verified". The information provided is only what the user has chosen to share with the client, and may even vary depending on which client is requesting this data.</p>

          <ul>
            <li id="profile-information-li-3"><code>name</code> - Name the user wishes to provide to the client. This is not to be considered by the client to be the full name of the user. Clients are expected to use this as a display name.</li>
            <li id="profile-information-li-4"><code>url</code> - URL of the user's website. The <code>url</code> is not guaranteed to match the <code>me</code> URL, and may even have a different host. For example, a multi-author website may use the website's URL as the <code>me</code> URL, but return each specific author's own personal website in the profile data.</li>
            <li id="profile-information-li-5"><code>photo</code> - A photo or image that the user wishes clients to use as a profile image.</li>
            <li id="profile-information-li-6"><code>email</code> - (if email scope is requested) The email address a user wishes to provide to the client.</li>
          </ul>

          <p id="profile-information-p-8">The client <em class="rfc2119" title="MUST NOT">MUST NOT</em> treat the information in the <code>profile</code> object as canonical or authoritative, and <em class="rfc2119" title="MUST NOT">MUST NOT</em> make any authentication or identification decisions based on this information.</p>

          <p id="profile-information-p-9">For example, attempting to use the <code>email</code> returned in the profile object as a user identifier will lead to security holes, as any user can create an authorization endpoint that returns any email address in the profile response. A client using the email address returned here should treat it the same as if it had been hand-entered in the client application and go through its own verification process before using it.</p>


        </section>

      </section>

      <section id="authorization-server-confirmation">
        <h3 id="x5-4-authorization-server-confirmation"><bdi class="secno">5.4 </bdi>Authorization Server Confirmation<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h3>
        <span id="differing-user-profile-urls"></span>

        <p id="authorization-server-confirmation-p-1">Clients will initially prompt the user to enter a URL in order to discover the necessary endpoints to perform authentication or authorization. However, there may be differences between the URL that the user initially enters and the final resulting profile URL as returned by the authorization server. The differences may be anything from a differing scheme (http vs https), to even a URL with a different host.</p>

        <p id="authorization-server-confirmation-p-2">Upon receiving the <code>me</code> URL in the response from the authorization server (either in the <a href="#profile-url-response">profile URL response</a> or <a href="#access-token-response">access token response</a>) the client <em class="rfc2119" title="MUST">MUST</em> verify the authorization server is authorized to make claims about the profile URL returned by confirming the returned profile URL declares the same authorization server.</p>

        <p id="authorization-server-confirmation-p-3">The client <em class="rfc2119" title="MUST">MUST</em> perform <a href="#discovery-by-clients">endpoint discovery</a> on the returned <code>me</code> URL and verify that URL declares the same authorization endpoint as was discovered in the initial discovery step, <b>unless</b> the returned <code>me</code> URL is an exact match of the initially entered URL or any of the URLs encountered during the <a href="#discovery-by-clients">initial endpoint discovery</a>, either from a possible redirect chain or as the final value.</p>

        <p id="authorization-server-confirmation-p-4">Note that the step of checking for the existence of the returned profile URL in the initial endpoint discovery is an optional optimization step which may save the client from possibly needing to make another HTTP request. This step may be skipped for simplicity, as discovering the authorization server from the returned profile URL is sufficient to confirm the returned profile URL declares the same authorization server.</p>

        <p id="authorization-server-confirmation-p-5">This verification step ensures that an authorization endpoint is not able to issue valid responses for arbitrary profile URLs, and that users on a shared domain cannot forge authorization on behalf of other users of that domain.</p>

        <h4 id="examples">Examples<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h4>

        <p id="authorization-server-confirmation-p-6">The following are some non-normative examples of real-world scenarios in which the initial user-entered URL may be different from the final resulting profile URL returned by the authorization server.</p>

        <h5 id="basic-redirect">Basic Redirect<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h5>

        <p id="authorization-server-confirmation-p-7">The basic redirect example covers cases such as:
          </p><ul>
            <li id="authorization-server-confirmation-li-1">entering a domain with a www prefix and resolving it to the main domain</li>
            <li id="authorization-server-confirmation-li-2">entering a URL with no scheme or with http and resolving it to an https URL</li>
            <li id="authorization-server-confirmation-li-3">entering a short domain and resolving it to a different longer domain</li>
          </ul>
        <p id="authorization-server-confirmation-p-8"></p>

        <p id="authorization-server-confirmation-p-9">Steps</p>

        <ol>
          <li id="authorization-server-confirmation-li-4">The user enters <code>www.example.com</code> into the client</li>
          <li id="authorization-server-confirmation-li-5">The client applies the steps from URL canonicalization to turn it into a URL: <code>http://www.example.com/</code></li>
          <li id="authorization-server-confirmation-li-6">The client makes a GET request to <code>http://www.example.com/</code></li>
          <li id="authorization-server-confirmation-li-7">The server returns a 301 redirect to <code>https://example.com/</code></li>
          <li id="authorization-server-confirmation-li-8">The client makes a GET request to <code>https://example.com/</code> and finds the authorization endpoint</li>
          <li id="authorization-server-confirmation-li-9">The client does the IndieAuth flow with that authorization endpoint. This results in the profile URL response with a <code>me</code> value of <code>https://example.com/</code> as the canonical Profile URL.</li>
          <li id="authorization-server-confirmation-li-10">The client sees that the canonical Profile URL matches the URL that the authorization endpoint was discovered at, and accepts the value <code>https://example.com/</code></li>
        </ol>

        <h5 id="service-domain-to-subdomain">Service Domain to Subdomain<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h5>

        <ol>
          <li id="authorization-server-confirmation-li-11">The user enters <code>example.com</code> into the client</li>
          <li id="authorization-server-confirmation-li-12">The client applies the steps from URL canonicalization to turn it into a URL: <code>http://example.com/</code></li>
          <li id="authorization-server-confirmation-li-13">The client makes a GET request to <code>http://example.com/</code></li>
          <li id="authorization-server-confirmation-li-14">The server returns a 301 redirect to <code>https://example.com/</code></li>
          <li id="authorization-server-confirmation-li-15">The client makes a GET request to <code>https://example.com/</code> and finds the authorization endpoint, <code>https://login.example.com</code></li>
          <li id="authorization-server-confirmation-li-16">The client does the IndieAuth flow with <code>https://login.example.com</code>. This results in the profile URL response with a <code>me</code> value of <code>https://username.example.com/</code> as the canonical Profile URL.</li>
          <li id="authorization-server-confirmation-li-17">This is the first time the client has seen this URL, so must verify the relationship between this subdomain and the authorization server. It fetches <code>https://username.example.com/</code> and finds the same authorization endpoint <code>https://login.example.com</code></li>
          <li id="authorization-server-confirmation-li-18">The client accepts the <code>me</code> value of <code>https://username.example.com/</code></li>
        </ol>

        <h5 id="service-domain-to-path">Service Domain to Path<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h5>

        <ol>
          <li id="authorization-server-confirmation-li-19">The user enters <code>example.com</code> into the client</li>
          <li id="authorization-server-confirmation-li-20">The client applies the steps from URL canonicalization to turn it into a URL: <code>http://example.com/</code></li>
          <li id="authorization-server-confirmation-li-21">The client makes a GET request to <code>http://example.com/</code></li>
          <li id="authorization-server-confirmation-li-22">The server returns a 301 redirect to <code>https://example.com/</code></li>
          <li id="authorization-server-confirmation-li-23">The client makes a GET request to <code>https://example.com/</code> and finds the authorization endpoint, <code>https://login.example.com</code></li>
          <li id="authorization-server-confirmation-li-24">The client does the IndieAuth flow with <code>https://login.example.com</code>. This results in the profile URL response with a <code>me</code> value of <code>https://example.com/username</code> as the canonical Profile URL.</li>
          <li id="authorization-server-confirmation-li-25">This is the first time the client has seen this URL, so must verify the relationship between this subdomain and the authorization server. It fetches <code>https://example.com/username</code> and finds the same authorization endpoint <code>https://login.example.com</code></li>
          <li id="authorization-server-confirmation-li-26">The client accepts the <code>me</code> value of <code>https://example.com/username</code></li>
        </ol>

        <h5 id="email-like-identifier">Email-like Identifier<a class="self-link" aria-label="§" href="#authorization-server-confirmation"></a></h5>

        <ol>
          <li id="authorization-server-confirmation-li-27">The user enters <code>user@example.com</code> into the client</li>
          <li id="authorization-server-confirmation-li-28">The client applies the steps from URL canonicalization to turn it into a URL: <code>http://user@example.com/</code></li>
          <li id="authorization-server-confirmation-li-29">The client makes a GET request to <code>http://example.com/</code> providing the HTTP Basic Auth username <code>user</code></li>
          <li id="authorization-server-confirmation-li-30">The server returns a 301 redirect to <code>https://example.com/</code></li>
          <li id="authorization-server-confirmation-li-31">The client makes a GET request to <code>https://example.com/</code> and finds the authorization endpoint, <code>https://login.example.com</code>
            <ul><li id="authorization-server-confirmation-li-32">Note: Alternatively the server can advertise the authorization endpoint in the response to the <code>http://user@example.com/</code> request directly instead of needing a separate redirect</li></ul>
          </li>
          <li id="authorization-server-confirmation-li-33">The client does the IndieAuth flow with <code>https://login.example.com</code>, providing the user-entered <code>user@example.com</code> in the request as a hint to the server. This results in the profile URL response with a <code>me</code> value of <code>https://example.com/username</code> as the canonical Profile URL.</li>
          <li id="authorization-server-confirmation-li-34">This is the first time the client has seen this URL, so must verify the relationship between this subdomain and the authorization server. It fetches <code>https://example.com/username</code> and finds the same authorization endpoint <code>https://login.example.com</code></li>
          <li id="authorization-server-confirmation-li-35">The client accepts the <code>me</code> value of <code>https://example.com/username</code></li>
        </ol>

      </section>

      <section id="refresh-tokens">
        <h3 id="x5-5-refresh-tokens"><bdi class="secno">5.5 </bdi>Refresh Tokens<a class="self-link" aria-label="§" href="#refresh-tokens"></a></h3>

        <p id="refresh-tokens-p-1">Refresh tokens are issued to the client by the authorization server and <em class="rfc2119" title="MAY">MAY</em> be used at any time to obtain a new access token, usually when the current access token becomes invalid or expires, or to obtain a new token with identical or narrower scope (access tokens may have a shorter lifetime and fewer permissions than authorized by the resource owner).</p>

        <p id="refresh-tokens-p-2">Use of short-lived access tokens and the offering of refresh tokens is <em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em>, however, issuing a refresh token is at the discretion of the authorization server, and may be issued based on properties of the client, properties of the request, policies within the authorization server, a choice by the user authorizing the request or any other criteria.  If the authorization server issues a refresh token, it is included in the return when issuing an access token. If the authorization server decides not to issue refresh tokens, or the refresh token expires, the client <em class="rfc2119" title="MAY">MAY</em> obtain new access tokens by starting the authorization flow over.</p>

        <p id="refresh-tokens-p-3">Authorization servers <em class="rfc2119" title="MAY">MAY</em> revoke refresh tokens automatically in case of a security event, such as a password change or a logout at the authorization server, or when they are redeemed, in which case a new refresh token <em class="rfc2119" title="MAY">MAY</em> be provided. Refresh tokens <em class="rfc2119" title="SHOULD">SHOULD</em> expire if the client has been inactive for some time, i.e., the refresh token has not been used to obtain fresh access tokens for some time.  The expiration time is at the discretion of the authorization server.</p>

        <section id="refreshing-an-access-token">
          <h4 id="x5-5-1-refreshing-an-access-token"><bdi class="secno">5.5.1 </bdi>Refreshing an Access Token<a class="self-link" aria-label="§" href="#refreshing-an-access-token"></a></h4>

          <p id="refreshing-an-access-token-p-1">To refresh an access token, the client makes a POST request to the token endpoint to exchange the refresh token for the new access token. The POST request contains the following parameters:</p>

          <ul>
            <li id="refreshing-an-access-token-li-1"><code>grant_type=refresh_token</code></li>
            <li id="refreshing-an-access-token-li-2"><code>refresh_token</code> - The refresh token previously offered to the client.</li>
            <li id="refreshing-an-access-token-li-3"><code>client_id</code> - The client ID that was used when the refresh token was issued.</li>
            <li id="refreshing-an-access-token-li-4"><code>scope</code> (optional) - The client may request a token with the same or fewer scopes than the original access token. If omitted, is treated as equal to the original scopes granted.</li>
          </ul>

          <p id="refreshing-an-access-token-p-2">For example:</p>

          <div class="example" id="example-12">
        <div class="marker">
    <a class="self-link" href="#example-12">Example<bdi> 12</bdi></a>
  </div> <pre class="nohighlight">POST https://example.org/token
Content-type: application/x-www-form-urlencoded
Accept: application/json

grant_type=refresh_token
&amp;refresh_token=xxxxxxxx&amp;client_id=https://app.example.com</pre>
      </div>

          <p id="refreshing-an-access-token-p-3">If valid and authorized, the authorization server issues an access token as noted in <a href="#access-token-response">Access Token Response</a>. The authorization server <em class="rfc2119" title="MAY">MAY</em> issue a new refresh token, in which case the client <em class="rfc2119" title="MUST">MUST</em> discard the old refresh token and replace it with the new refresh token. The authorization server <em class="rfc2119" title="MAY">MAY</em> revoke the old refresh token after issuing a new refresh token to the client.  If a new refresh token is issued, the refresh token scope <em class="rfc2119" title="MUST">MUST</em> be identical to that of the refresh token included by the client in the request.</p>

          <p id="refreshing-an-access-token-p-4">Refresh tokens <em class="rfc2119" title="SHOULD">SHOULD</em> expire if the client has not used the refresh token to obtain new access tokens for some time. The expiration time is at the discretion of the authorization server.</p>

        </section>
      </section>

    </section>

    <section class="normative" id="access-token-verification">
      <h2 id="x6-access-token-verification"><bdi class="secno">6. </bdi>Access Token Verification<a class="self-link" aria-label="§" href="#access-token-verification"></a></h2>

      <p id="access-token-verification-p-1">In OAuth 2.0, access tokens are opaque to clients, so clients do not need to know anything about the contents or structure of the token itself. Additionally, endpoints that clients make requests to, such as [<cite><a class="bibref" data-link-type="biblio" href="#bib-micropub" title="Micropub">Micropub</a></cite>] endpoints, may not even understand how to interpret tokens if they were issued by a standalone token endpoint. If the token endpoint is not tightly integrated with the resource server the client is interacting with, then the resource server needs a way to verify access tokens that it receives from clients. If the token endpoint and Micropub endpoint are tightly coupled, then they can of course use an internal mechanism to verify access tokens.</p>

      <p id="access-token-verification-p-2">Token endpoints that intend to interoperate with other endpoints <em class="rfc2119" title="MUST">MUST</em> use the mechanism described below to allow resource servers such as Micropub endpoints to verify access tokens.</p>

      <section id="access-token-verification-request">
        <h3 id="x6-1-access-token-verification-request"><bdi class="secno">6.1 </bdi>Access Token Verification Request<a class="self-link" aria-label="§" href="#access-token-verification-request"></a></h3>

        <p id="access-token-verification-request-p-1">If a resource server needs to verify that an access token is valid, it may do so using Token Introspection. IndieAuth extends OAuth 2.0 Token Introspection [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7662" title="OAuth 2.0 Token Introspection">RFC7662</a></cite>] by adding that the  introspection response <em class="rfc2119" title="MUST">MUST</em> include an additional parameter, <code>me</code>.</p>
        <p id="access-token-verification-request-p-2">Note that the request to the endpoint will not contain any user-identifying information, so the resource server (e.g. Micropub endpoint) will need to know via out-of-band methods which token endpoint is in use.</p>
        <p id="access-token-verification-request-p-3">The resource server <em class="rfc2119" title="SHOULD">SHOULD</em> make a POST request to the token endpoint containing the Bearer token in the <code>token</code> parameter, which will generate a token verification response. The endpoint <em class="rfc2119" title="MUST">MUST</em> also require some form of authorization to access this endpoint and <em class="rfc2119" title="MAY">MAY</em> identify that in the <code>introspection_endpoint_auth_methods_supported</code> parameter of the metadata response. If the authorization is insufficient for the request, the authorization server <em class="rfc2119" title="MUST">MUST</em> respond with an HTTP 401 code.</p>

        <div class="example" id="example-13">
        <div class="marker">
    <a class="self-link" href="#example-13">Example<bdi> 13</bdi></a>
  </div> <pre class="nohighlight">POST https://indieauth.example.com/introspect
Content-type: application/x-www-form-urlencoded
Accept: application/json
Authorization: Bearer xxxxxxxx

token=xxxxxxxx</pre>
      </div>
      </section>

      <section id="access-token-verification-response">
        <h3 id="x6-2-access-token-verification-response"><bdi class="secno">6.2 </bdi>Access Token Verification Response<a class="self-link" aria-label="§" href="#access-token-verification-response"></a></h3>

        <p id="access-token-verification-response-p-1">The token endpoint verifies the access token (how this verification is done is up to the implementation), and returns information about the token:</p>

        <ul>
          <li id="access-token-verification-response-li-1"><code>active</code> - (required) Boolean indicator of whether or not the presented token is currently active</li>
          <li id="access-token-verification-response-li-2"><code>me</code> - (required) The profile URL of the user corresponding to this token</li>
          <li id="access-token-verification-response-li-3"><code>client_id</code> - The client ID associated with this token</li>
          <li id="access-token-verification-response-li-4"><code>scope</code> - A space-separated list of scopes associated with this token</li>
          <li id="access-token-verification-response-li-5"><code>exp</code> - (optional) Integer timestamp, measured in the number of seconds since January 1 1970 UTC, indicating when this token will expire</li>
          <li id="access-token-verification-response-li-6"><code>iat</code> - (optional) Integer timestamp, measured in the number of seconds since January 1 1970 UTC, indicating when this token was originally issued</li>
        </ul>

        <div class="example" id="example-14">
        <div class="marker">
    <a class="self-link" href="#example-14">Example<bdi> 14</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "active": "true",
  "me": "https://user.example.net/",
  "client_id": https://app.example.com/",
  "scope": "create update delete"
  "exp": "1632443647",
  "iat": "1632443147"
}</pre>
      </div>

        <p id="access-token-verification-response-p-2">Specific implementations <em class="rfc2119" title="MAY">MAY</em> include additional parameters as top-level JSON properties. Clients <em class="rfc2119" title="SHOULD">SHOULD</em> ignore parameters they don't recognize.</p>

        <p id="access-token-verification-response-p-3">If the token is not valid, the endpoint still <em class="rfc2119" title="MUST">MUST</em> return a 200 Response, with the only parameter being active(with its value set to "false"). The response <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> include any additional information about an inactive token, including why the token is inactive.</p>

        <div class="example" id="example-15">
        <div class="marker">
    <a class="self-link" href="#example-15">Example<bdi> 15</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
  "active": "false",
}</pre>
      </div>

      </section>
    </section>


    <section class="normative" id="token-revocation">
      <h2 id="x7-token-revocation"><bdi class="secno">7. </bdi>Token Revocation<a class="self-link" aria-label="§" href="#token-revocation"></a></h2>

      <p id="token-revocation-p-1">A client may wish to explicitly disable an access token that it has obtained, such as when the user signs out of the client. IndieAuth implements OAuth 2.0 Token Revocation [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7009" title="OAuth 2.0 Token Revocation">RFC7009</a></cite>] using the revocation endpoint defined in the server metadata:</p>

      <section id="token-revocation-request">
        <h3 id="x7-1-token-revocation-request"><bdi class="secno">7.1 </bdi>Token Revocation Request<a class="self-link" aria-label="§" href="#token-revocation-request"></a></h3>

        <p id="token-revocation-request-p-1">An example revocation request is below.</p>

        <div class="example" id="example-16">
        <div class="marker">
    <a class="self-link" href="#example-16">Example<bdi> 16</bdi></a>
  </div> <pre class="nohighlight">POST https://indieauth.example.com/revocation HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Accept: application/json

token=xxxxxxxx</pre>
      </div>

        <p id="token-revocation-request-p-2">As described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7009" title="OAuth 2.0 Token Revocation">RFC7009</a></cite>], the revocation endpoint responds with HTTP 200 for both the case where the token was successfully revoked, or if the submitted token was invalid.</p>
      </section>

      <p class="advisement" id="token-revocation-p-4">
        A previous version of the spec used the token endpoint as the revocation endpoint with the additional parameter <code>action=revoke</code>. Servers that wish to support older versions of clients may wish to retain this behavior for backwards compatibility.</p>
      <p id="token-revocation-p-5"></p>
    </section>


    <section id="accessing-protected-resources">
      <h2 id="x8-accessing-protected-resources"><bdi class="secno">8. </bdi>Accessing Protected Resources<a class="self-link" aria-label="§" href="#accessing-protected-resources"></a></h2>

      <p id="accessing-protected-resources-p-1">The client accesses protected resources by presenting the access token to the resource server.  The resource server <em class="rfc2119" title="MUST">MUST</em> validate the access token and ensure that it has not expired and that its scope covers the requested resource.</p>

      <section id="error-responses">
        <h3 id="x8-1-error-responses"><bdi class="secno">8.1 </bdi>Error Responses<a class="self-link" aria-label="§" href="#error-responses"></a></h3>

        <p id="error-responses-p-1">When a request fails, the resource server responds using the appropriate HTTP status codes, and includes one of the following error codes in the response:</p>

        <ul>
          <li id="error-responses-li-1"><code>"invalid_request"</code> - The request is not valid. The resource server <em class="rfc2119" title="SHOULD">SHOULD</em> respond with HTTP 400</li>
          <li id="error-responses-li-2"><code>"invalid_token"</code> - The access token provided is expired, revoked, or invalid. The resource server <em class="rfc2119" title="SHOULD">SHOULD</em> respond with HTTP 401</li>
          <li id="error-responses-li-3"><code>"insufficient_scope"</code> - The request requires higher privileges than provided. The resource server <em class="rfc2119" title="SHOULD">SHOULD</em> respond with HTTP 403</li>
        </ul>

        <p id="error-responses-p-2">If the requests lacks any authentication information, the resource server <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> include an error code or other information.</p>
      </section>
    </section>

    <section id="user-information">
      <h2 id="x9-user-information"><bdi class="secno">9. </bdi>User Information<a class="self-link" aria-label="§" href="#user-information"></a></h2>

      <p id="user-information-p-1">A client may wish to refresh or receive additional information about the authenticated end user outside of the authorization response. To fetch the user's profile information, the client makes a GET request to the userinfo endpoint, providing an access token that was issued with the <code>profile</code> and/or <code>email</code> scopes.</p>

      <div class="example" id="example-17">
        <div class="marker">
    <a class="self-link" href="#example-17">Example<bdi> 17</bdi></a>
  </div> <pre class="nohighlight">GET /userinfo HTTP/1.1
Host: indieauth.example.com
Authorization: Bearer xxxxxxxxxxx</pre>
      </div>

      <p id="user-information-p-2">The authorization server returns a JSON [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7159" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC7159</a></cite>] object identical to the profile property identified in <a href="#profile-information">Profile Information</a> when a <code>response_type</code> value is used that results in an access token being issued and would require the same <code>profile</code> or <code>email</code> scopes. The considerations identified in <a href="#profile-information">Profile Information</a> regarding the non-authoritative nature of the information would also apply here.</p>
      <p id="user-information-p-3">If the request lacks a provided access token, or the token does not contain appropriate scopes, the endpoint <em class="rfc2119" title="SHOULD">SHOULD</em> respond with an error response as noted in <a href="#accessing-protected-resources">Accessing Protected Resources</a>.</p>
      <p id="user-information-p-4">Like the return of profile information in the authorization response, implementation of the userinfo endpoint is entirely optional. If implemented, discovery would be through the <code>userinfo_endpoint</code> property in the authorization server metadata document.</p>

      <div class="example" id="example-18">
        <div class="marker">
    <a class="self-link" href="#example-18">Example<bdi> 18</bdi></a>
  </div> <pre class="nohighlight">HTTP/1.1 200 OK
Content-Type: application/json

{
    "name": "Example User",
    "url": "https://user.example.net/",
    "photo": "https://user.example.net/photo.jpg",
    "email": "user@example.net"
}</pre>
      </div>

    </section>

    <section id="security-considerations">
      <h2 id="x10-security-considerations"><bdi class="secno">10. </bdi>Security Considerations<a class="self-link" aria-label="§" href="#security-considerations"></a></h2>

      <p id="security-considerations-p-1">In addition to the security considerations in OAuth 2.0 Core [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] and OAuth 2.0 Threat Model and Security Considerations [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6819" title="OAuth 2.0 Threat Model and Security Considerations">RFC6819</a></cite>], the additional considerations apply.</p>

      <section id="preventing-phishing-and-redirect-attacks">
        <h3 id="x10-1-preventing-phishing-and-redirect-attacks"><bdi class="secno">10.1 </bdi>Preventing Phishing and Redirect Attacks<a class="self-link" aria-label="§" href="#preventing-phishing-and-redirect-attacks"></a></h3>

        <p id="preventing-phishing-and-redirect-attacks-p-1">Authorization servers <em class="rfc2119" title="SHOULD">SHOULD</em> fetch the <code>client_id</code> provided in the authentication or authorization request in order to provide users with additional information about the request, such as the application name and logo. If the server does not fetch the client information, then it <em class="rfc2119" title="SHOULD">SHOULD</em> take additional measures to ensure the user is provided with as much information as possible about the request.</p>

        <p id="preventing-phishing-and-redirect-attacks-p-2">The authorization server <em class="rfc2119" title="SHOULD">SHOULD</em> display the full <code>client_id</code> on the authorization interface, in addition to displaying the fetched application information if any. Displaying the <code>client_id</code> helps users know that they are authorizing the expected application.</p>

        <p id="preventing-phishing-and-redirect-attacks-p-3">Since IndieAuth clients are likely to be public clients (if no <a href="https://datatracker.ietf.org/doc/html/rfc7591#section-2"><code>jwks_uri</code></a> is advertised in the client metatadata), the only measure available to protect against some attacks described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6819" title="OAuth 2.0 Threat Model and Security Considerations">RFC6819</a></cite>] is strong verification of the client's <code>redirect_uri</code>. If the <code>redirect_uri</code> scheme, host or port differ from that of the <code>client_id</code>, then the authorization server <em class="rfc2119" title="MUST">MUST</em> either verify the redirect URL as described in <a href="#redirect-url">Redirect URL</a>, or display the redirect URL to the user so they can inspect it manually.</p>
      </section>

    </section>

    <section id="iana-considerations">
      <h2 id="x11-iana-considerations"><bdi class="secno">11. </bdi>IANA Considerations<a class="self-link" aria-label="§" href="#iana-considerations"></a></h2>

      <p id="iana-considerations-p-1">The link relation types below are documented to be registered by IANA per Section 6.2.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>]:</p>

      <dl>
        <dt>Relation Name:</dt>
        <dd>indieauth-metadata</dd>

        <dt>Description:</dt>
        <dd>Used for discovery of the OAuth 2.0 metadata document given an IndieAuth profile URL.</dd>

        <dt>Reference:</dt>
        <dd><a href="https://indieauth.spec.indieweb.org/">IndieAuth Specification (https://indieauth.spec.indieweb.org/)</a></dd>
      </dl>

      <dl>
        <dt>Relation Name:</dt>
        <dd>redirect_uri</dd>

        <dt>Description:</dt>
        <dd>Used for an authorization server to discover the OAuth 2.0 redirect URI for a client given the client's IndieAuth client ID.</dd>

        <dt>Reference:</dt>
        <dd><a href="https://indieauth.spec.indieweb.org/">IndieAuth Specification (https://indieauth.spec.indieweb.org/)</a></dd>
      </dl>
    </section>

    

    <section class="appendix informative" id="resources">
      <h2 id="a-resources"><bdi class="secno">A. </bdi>Resources<a class="self-link" aria-label="§" href="#resources"></a></h2><p id="resources-p-1"><em>This section is non-normative.</em></p>

      <p id="resources-p-2">
        </p><ul>
          
          <li id="resources-li-1"><a href="https://indieweb.org/Category:IndieAuth">More IndieAuth resources</a></li>
          <li id="resources-li-2"><a href="https://indieweb.org/obtaining-an-access-token">Implementation guide for obtaining an access token using IndieAuth</a></li>
          <li id="resources-li-3"><a href="https://indieweb.org/indieauth-for-login">Implementation guide for authenticating users without obtaining an access token</a></li>
        </ul>
      <p id="resources-p-3"></p>

      <section class="appendix informative" id="articles">
        <h3 id="a-1-articles"><bdi class="secno">A.1 </bdi>Articles<a class="self-link" aria-label="§" href="#articles"></a></h3><p id="articles-p-1"><em>This section is non-normative.</em></p>

        <p id="articles-p-2">You can find a list of <a href="https://indieweb.org/IndieAuth#Articles">articles about IndieAuth</a> on the IndieWeb wiki.</p>
      </section>

      <section class="appendix informative" id="implementations">
        <h3 id="a-2-implementations"><bdi class="secno">A.2 </bdi>Implementations<a class="self-link" aria-label="§" href="#implementations"></a></h3><p id="implementations-p-1"><em>This section is non-normative.</em></p>

        <p id="implementations-p-2">You can find a list of <a href="https://indieauth.net/implementations">IndieAuth implementations</a> on indieauth.net</p>
      </section>

    </section>

    <section class="appendix" id="acknowledgements">
      <h2 id="b-acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements<a class="self-link" aria-label="§" href="#acknowledgements"></a></h2>

      <p id="acknowledgements-p-1">The editor wishes to thank the <a href="https://indieweb.org/">IndieWeb</a>
        community and other implementers for their contributions, support, encouragement and enthusiasm,
        including but not limited to: Angelo Gladding, Amy Guy, Barnaby Walters, Benjamin Roberts, Bret Comnes, Christian Weiske, David Shanske, David Somers, Dmitri Shuralyov, Emelia Smith, Fluffy, François Kooman, Jamie Tanna, Jeena Paradies, Manton Reece, Martijn van der Ven, Sebastiaan Andeweg, Sven Knebel, and Tantek Çelik.</p>
    </section>

    <section class="appendix informative" id="change-log">
      <h2 id="c-change-log"><bdi class="secno">C. </bdi>Change Log<a class="self-link" aria-label="§" href="#change-log"></a></h2><p id="change-log-p-1"><em>This section is non-normative.</em></p>

      <section id="changes-from-12-february-2022-to-this-version">
        <h3 id="c-1-changes-from-12-february-2022-to-this-version"><bdi class="secno">C.1 </bdi>Changes from 12 February 2022 to this version<a class="self-link" aria-label="§" href="#changes-from-12-february-2022-to-this-version"></a></h3>
        <ul>
          <li id="changes-from-12-february-2022-to-this-version-li-1">Client metadata discovery now happens via JSON rather than Microformats, referencing OAuth Client ID Metadata Document</li>
          <li id="changes-from-12-february-2022-to-this-version-li-2">Fixes and editorial changes</li>
        </ul>
      </section>

      <section id="changes-from-26-november-2020-to-12-february-2022">
        <h3 id="c-2-changes-from-26-november-2020-to-12-february-2022"><bdi class="secno">C.2 </bdi>Changes from 26 November 2020 to 12 February 2022<a class="self-link" aria-label="§" href="#changes-from-26-november-2020-to-12-february-2022"></a></h3>
        <ul>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-1">IndieAuth servers now use OAuth Server Metadata to publish their endpoints, and user profile URLs should link to the metadata document instead of the individual authorization endpoint and token endpoint</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-2">Defines the revocation endpoint in the server metadata instead of overriding the token endpoint</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-3">Defines token introspection as a new endpoint and new response format instead of overriding the token endpoint</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-4">Adds a new <code>userinfo</code> endpoint to fetch updated profile data</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-5">Adds the OAuth 2.0 <code>iss</code> parameter to the authorization response</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-6">Adds a section describing refresh token usage. (Note that this was always possible in IndieAuth, but many people didn't know it was an option because it wasn't described here.)</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-7">Fixed redirect URL example in Authorization Response</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-8">Clarifications around the use of the profile scope in profile response and token response</li>
          <li id="changes-from-26-november-2020-to-12-february-2022-li-9">Note that the authorization server must not fetch the client_id URL if it's a localhost URL</li>
        </ul>
      </section>

      <section id="changes-from-26-september-2020-to-26-november-2020">
        <h3 id="c-3-changes-from-26-september-2020-to-26-november-2020"><bdi class="secno">C.3 </bdi>Changes from 26 September 2020 to 26 November 2020<a class="self-link" aria-label="§" href="#changes-from-26-september-2020-to-26-november-2020"></a></h3>
        <ul>
          <li id="changes-from-26-september-2020-to-26-november-2020-li-1">Remove same-domain requirement for entered and final profile URL by instead having the client <a href="#authorization-server-confirmation">confirm the authorization server</a></li>
          <li id="changes-from-26-september-2020-to-26-november-2020-li-2">Only the <code>me</code> value returned by the authorization server is a profile URL, do not refer to the user provided URL as such</li>
          <li id="changes-from-26-september-2020-to-26-november-2020-li-3">Editorial changes to use the term "host" instead of "domain" where appropriate</li>
        </ul>
      </section>

      <section id="changes-from-09-august-2020-to-26-september-2020">
        <h3 id="c-4-changes-from-09-august-2020-to-26-september-2020"><bdi class="secno">C.4 </bdi>Changes from 09 August 2020 to 26 September 2020<a class="self-link" aria-label="§" href="#changes-from-09-august-2020-to-26-september-2020"></a></h3>
        <ul>
          <li id="changes-from-09-august-2020-to-26-september-2020-li-1">Make the <code>me</code> parameter optional (but recommended) in the authorization request</li>
          <li id="changes-from-09-august-2020-to-26-september-2020-li-2">Add the option of returning profile information in the response as well as defining profile scopes</li>
          <li id="changes-from-09-august-2020-to-26-september-2020-li-3">Incorporate PKCE into the spec</li>
          <li id="changes-from-09-august-2020-to-26-september-2020-li-4">Fixed text about which URL to resolve relative authorization/token endpoint URLs from</li>
        </ul>
      </section>

      <section id="changes-from-25-january-2020-to-09-august-2020">
        <h3 id="c-5-changes-from-25-january-2020-to-09-august-2020"><bdi class="secno">C.5 </bdi>Changes from 25 January 2020 to 09 August 2020<a class="self-link" aria-label="§" href="#changes-from-25-january-2020-to-09-august-2020"></a></h3>
        <ul>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-1">Use <code>response_type=code</code> and make it required, to bring it in line with OAuth 2.0</li>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-2">Require <code>grant_type=authorization_code</code> when redeeming the authorization code at the authorization endpoint</li>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-3">Drop the <code>me</code> parameter from the token endpoint request</li>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-4">Consolidate the authentication and authorization sections into a single section, describing only the difference which is the response returned.</li>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-5">Drop the section describing communication between token endpoints and authorization endpoints as it was underused</li>
          <li id="changes-from-25-january-2020-to-09-august-2020-li-6">Editorial changes and rearranging sections</li>
        </ul>
      </section>

      <section id="changes-from-03-march-2019-to-25-january-2020">
        <h3 id="c-6-changes-from-03-march-2019-to-25-january-2020"><bdi class="secno">C.6 </bdi>Changes from 03 March 2019 to 25 January 2020<a class="self-link" aria-label="§" href="#changes-from-03-march-2019-to-25-january-2020"></a></h3>
        <ul>
          <li id="changes-from-03-march-2019-to-25-january-2020-li-1">Use "authentication" and "authorization" more consistently in paragraphs and diagrams</li>
          <li id="changes-from-03-march-2019-to-25-january-2020-li-2">Clarify that "Authorization Code Flow" is "OAuth 2.0 Authorization Code Flow"</li>
          <li id="changes-from-03-march-2019-to-25-january-2020-li-3">Minor typo fixes</li>
        </ul>
      </section>

      <section id="changes-from-07-july-2018-to-03-march-2019">
        <h3 id="c-7-changes-from-07-july-2018-to-03-march-2019"><bdi class="secno">C.7 </bdi>Changes from 07 July 2018 to 03 March 2019<a class="self-link" aria-label="§" href="#changes-from-07-july-2018-to-03-march-2019"></a></h3>
        <ul>
          <li id="changes-from-07-july-2018-to-03-march-2019-li-1">Updates the spec header to note that it is a living standard</li>
          <li id="changes-from-07-july-2018-to-03-march-2019-li-2">Minor typo fixes</li>
        </ul>
      </section>

      <section id="changes-from-23-january-2018-to-07-july-2018">
        <h3 id="c-8-changes-from-23-january-2018-to-07-july-2018"><bdi class="secno">C.8 </bdi>Changes from <a href="https://www.w3.org/TR/2018/NOTE-indieauth-20180123/">23 January 2018</a> to 07 July 2018<a class="self-link" aria-label="§" href="#changes-from-23-january-2018-to-07-july-2018"></a></h3>
        <ul>
          <li id="changes-from-23-january-2018-to-07-july-2018-li-1">Replaced references to RFC 5988 with RFC 8288 (<a href="https://github.com/indieweb/indieauth/commit/69d1d51e9541d8b76233793099b359de898a7154">diff</a>)</li>
          <li id="changes-from-23-january-2018-to-07-july-2018-li-2">Added <code>Accept: application/json</code> header to example requests (<a href="https://github.com/indieweb/indieauth/commit/bfa39332ea3a38ff31efb7101db5b20f2ecbaff7">diff</a>)</li>
        </ul>
      </section>

      <section id="changes-from-07-july-2018-to-03-march-2019-0">
        <h3 id="c-9-changes-from-07-july-2018-to-03-march-2019"><bdi class="secno">C.9 </bdi>Changes from 07 July 2018 to 03 March 2019<a class="self-link" aria-label="§" href="#changes-from-07-july-2018-to-03-march-2019-0"></a></h3>

        <ul>
          <li id="changes-from-07-july-2018-to-03-march-2019-0-li-1">Added missing ampersand in HTTP redirect example (<a href="https://github.com/indieweb/indieauth/commit/ffaf128e01712ca38f3a7dd412749c2bf2f1c99a">diff</a>)</li>
          <li id="changes-from-07-july-2018-to-03-march-2019-0-li-2">Fixed broken references section (<a href="https://github.com/indieweb/indieauth/commit/7f90282274d2703363265d0914b90ce7be8ac0b6">diff</a>)</li>
          <li id="changes-from-07-july-2018-to-03-march-2019-0-li-3">Fixed internal link to redirect examples (<a href="https://github.com/indieweb/indieauth/commit/e3eef35c2d16e4a4a00767c8da4ac55ad02d7bc0">diff</a>)</li>
        </ul>
      </section>
    </section>

    <script>
    // After text is selected (mouseup), find the closest element that has an ID
    // attribute, and update the browser location bar to include that as the fragment
    document.body.onmouseup = function(){
      var selection;
      if(selection=window.getSelection()) {
        var range = selection.getRangeAt(0);
        var el = range.startContainer;
        while((el=el.parentElement) && !el.attributes["id"]);
        var hash = el.attributes["id"].value;
        if(history.replaceState) {
          history.replaceState(null, null, "#"+hash);
        }
      }
    };
    </script>
  

<section id="references" class="appendix"><h2 id="d-references"><bdi class="secno">D. </bdi>References<a class="self-link" aria-label="§" href="#references"></a></h2><section id="normative-references">
      <h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>
        Normative references
      <a class="self-link" aria-label="§" href="#normative-references"></a></h3>
    <dl class="bibliography">
      <dt id="bib-clientidmetadatadocument">[ClientIDMetadataDocument]</dt><dd><a href="https://datatracker.ietf.org/doc/html/draft-parecki-oauth-client-id-metadata-document"><cite>OAuth Client ID Metadata Document</cite></a>. Aaron Parecki; Emelia Smith.  IETF. Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-parecki-oauth-client-id-metadata-document">https://datatracker.ietf.org/doc/html/draft-parecki-oauth-client-id-metadata-document</a></dd><dt id="bib-clientmetadata">[ClientMetadata]</dt><dd><a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata"><cite>OAuth Dynamic Client Registration Metadata</cite></a>. IETF.  IANA. Registry. URL: <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata">https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#client-metadata</a></dd><dt id="bib-fetch">[Fetch]</dt><dd><a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></dd><dt id="bib-html">[HTML]</dt><dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd><dt id="bib-rfc2119">[RFC2119]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a></dd><dt id="bib-rfc5735">[RFC5735]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc5735"><cite>Special Use IPv4 Addresses</cite></a>. M. Cotton; L. Vegoda.  IETF. January 2010. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc5735">https://www.rfc-editor.org/rfc/rfc5735</a></dd><dt id="bib-rfc6749">[RFC6749]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc6749"><cite>The OAuth 2.0 Authorization Framework</cite></a>. D. Hardt, Ed..  IETF. October 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a></dd><dt id="bib-rfc6750">[RFC6750]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc6750"><cite>The OAuth 2.0 Authorization Framework: Bearer Token Usage</cite></a>. M. Jones; D. Hardt.  IETF. October 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6750">https://www.rfc-editor.org/rfc/rfc6750</a></dd><dt id="bib-rfc7009">[RFC7009]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc7009"><cite>OAuth 2.0 Token Revocation</cite></a>. T. Lodderstedt, Ed.; S. Dronia; M. Scurtescu.  IETF. August 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7009">https://www.rfc-editor.org/rfc/rfc7009</a></dd><dt id="bib-rfc7159">[RFC7159]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc7159"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed..  IETF. March 2014. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a></dd><dt id="bib-rfc7231">[RFC7231]</dt><dd><a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..  IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a></dd><dt id="bib-rfc7591">[RFC7591]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc7591"><cite>OAuth 2.0 Dynamic Client Registration Protocol</cite></a>. J. Richer, Ed.; M. Jones; J. Bradley; M. Machulak; P. Hunt.  IETF. July 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7591">https://www.rfc-editor.org/rfc/rfc7591</a></dd><dt id="bib-rfc7636">[RFC7636]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc7636"><cite>Proof Key for Code Exchange by OAuth Public Clients</cite></a>. N. Sakimura, Ed.; J. Bradley; N. Agarwal.  IETF. September 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a></dd><dt id="bib-rfc7662">[RFC7662]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc7662"><cite>OAuth 2.0 Token Introspection</cite></a>. J. Richer, Ed..  IETF. October 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7662">https://www.rfc-editor.org/rfc/rfc7662</a></dd><dt id="bib-rfc8288">[RFC8288]</dt><dd><a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. M. Nottingham.  IETF. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a></dd><dt id="bib-rfc8414">[RFC8414]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc8414"><cite>OAuth 2.0 Authorization Server Metadata</cite></a>. M. Jones; N. Sakimura; J. Bradley.  IETF. June 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a></dd><dt id="bib-rfc9207">[RFC9207]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc9207"><cite>OAuth 2.0 Authorization Server Issuer Identification</cite></a>. K. Meyer zu Selhausen; D. Fett.  IETF. March 2022. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9207">https://www.rfc-editor.org/rfc/rfc9207</a></dd><dt id="bib-url">[URL]</dt><dd><a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a></dd>
    </dl></section><section id="informative-references">
      <h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>
        Informative references
      <a class="self-link" aria-label="§" href="#informative-references"></a></h3>
    <dl class="bibliography">
      <dt id="bib-micropub">[Micropub]</dt><dd><a href="https://www.w3.org/TR/micropub/"><cite>Micropub</cite></a>. Aaron Parecki.  W3C. 23 May 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/micropub/">https://www.w3.org/TR/micropub/</a></dd><dt id="bib-relmeauth">[RelMeAuth]</dt><dd><a href="https://microformats.org/wiki/RelMeAuth"><cite>RelMeAuth</cite></a>. Tantek Çelik.  microformats.org. Living Specification. URL: <a href="https://microformats.org/wiki/RelMeAuth">https://microformats.org/wiki/RelMeAuth</a></dd><dt id="bib-rfc6819">[RFC6819]</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc6819"><cite>OAuth 2.0 Threat Model and Security Considerations</cite></a>. T. Lodderstedt, Ed.; M. McGloin; P. Hunt.  IETF. January 2013. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6819">https://www.rfc-editor.org/rfc/rfc6819</a></dd>
    </dl></section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>